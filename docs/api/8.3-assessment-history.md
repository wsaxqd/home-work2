# API 8.3 - 获取评估历史

## 接口信息

- **接口名称**: 获取评估历史
- **请求方法**: GET
- **请求路径**: `/api/assessment/history`
- **需要认证**: 是

---

## 接口描述

获取用户的评估历史记录，支持按科目、日期范围筛选，可查看历史成绩趋势。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |

### Query参数
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| subject | String | 否 | 科目筛选 | "math", "chinese" |
| startDate | String | 否 | 开始日期(ISO 8601) | "2024-01-01" |
| endDate | String | 否 | 结束日期(ISO 8601) | "2024-12-31" |
| page | Number | 否 | 页码(默认1) | 1 |
| pageSize | Number | 否 | 每页数量(默认20) | 20 |

### 请求示例

```http
GET /api/assessment/history?subject=math&page=1&pageSize=20
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "assessmentId": "550e8400-e29b-41d4-a716-446655440000",
      "subject": "math",
      "difficulty": "medium",
      "score": 85,
      "totalScore": 100,
      "accuracy": 0.85,
      "correctCount": 8,
      "wrongCount": 2,
      "totalCount": 10,
      "timeSpent": 300,
      "rank": "优秀",
      "createdAt": "2024-12-20T10:30:00.000Z"
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440002",
      "assessmentId": "550e8400-e29b-41d4-a716-446655440003",
      "subject": "math",
      "difficulty": "easy",
      "score": 95,
      "totalScore": 100,
      "accuracy": 0.95,
      "correctCount": 9,
      "wrongCount": 1,
      "totalCount": 10,
      "timeSpent": 250,
      "rank": "优秀",
      "createdAt": "2024-12-19T14:20:00.000Z"
    }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "total": 45,
    "totalPages": 3
  },
  "statistics": {
    "totalAssessments": 45,
    "averageScore": 82.5,
    "averageAccuracy": 0.825,
    "bestScore": 98,
    "recentTrend": "上升"
  }
}
```

### 错误响应

#### 400 Bad Request - 参数错误
```json
{
  "success": false,
  "message": "日期格式不正确"
}
```

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "请先登录"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "获取历史记录失败"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 评估结果ID |
| assessmentId | UUID | 评估ID |
| subject | String | 科目 |
| difficulty | String | 难度等级 |
| score | Number | 得分 |
| totalScore | Number | 总分 |
| accuracy | Number | 正确率 |
| correctCount | Number | 答对题数 |
| wrongCount | Number | 答错题数 |
| totalCount | Number | 总题数 |
| timeSpent | Number | 用时(秒) |
| rank | String | 评级 |
| createdAt | DateTime | 完成时间 |
| statistics.totalAssessments | Number | 总评估次数 |
| statistics.averageScore | Number | 平均分 |
| statistics.averageAccuracy | Number | 平均正确率 |
| statistics.bestScore | Number | 最高分 |
| statistics.recentTrend | String | 近期趋势 |

---

## 业务规则

1. 只能查看自己的评估历史
2. 按完成时间倒序排列(最新的在前)
3. 支持科目、日期范围筛选
4. 返回统计摘要数据
5. 支持分页查询
6. 默认每页20条记录

---

## 使用场景

- 查看学习历史记录
- 分析学习进度趋势
- 对比不同时期成绩
- 导出学习报告数据

---

## 注意事项

1. 历史记录永久保存
2. 可用于分析学习进度和薄弱环节
3. 趋势分析基于近期10次评估
4. 建议定期查看历史记录总结学习情况

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`GET`
3. 输入URL：`http://localhost:3000/api/assessment/history?subject=math`
4. 在Headers中添加：
   - Key: `Authorization`
   - Value: `Bearer {你的accessToken}`
5. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回评估历史列表
- 包含分页信息和统计数据

---

## 相关接口

- [8.1 获取评估题目](./8.1-get-questions.md)
- [8.2 提交评估](./8.2-submit-assessment.md)
- [8.4 获取学习进度报告](./8.4-progress-report.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-22 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-22
