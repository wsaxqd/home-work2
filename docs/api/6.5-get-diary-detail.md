# API 6.5 - 获取日记详情

## 接口信息

- **接口名称**: 获取日记详情
- **请求方法**: GET
- **请求路径**: `/api/diary/:id`
- **需要认证**: 是

---

## 接口描述

获取指定日记的完整详情，包括所有字段和内容。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |

### Path参数
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| id | UUID | 是 | 日记ID | "550e8400-e29b-41d4-a716-446655440000" |

### 请求示例

```
GET /api/diary/550e8400-e29b-41d4-a716-446655440000
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "message": "获取成功",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "660e8400-e29b-41d4-a716-446655440000",
    "title": "快乐的一天",
    "content": "今天学习了很多知识，完成了三个小游戏，感觉非常开心！爸爸妈妈都夸奖我了。早上起床后我先复习了昨天学的内容，然后开始新的学习...",
    "mood": "happy",
    "weather": "sunny",
    "images": [
      "https://example.com/image1.jpg",
      "https://example.com/image2.jpg"
    ],
    "tags": ["学习", "成长", "游戏"],
    "is_public": false,
    "diary_date": "2024-12-21",
    "created_at": "2024-12-21T14:30:00.000Z",
    "updated_at": "2024-12-21T14:30:00.000Z",
    "author": {
      "id": "660e8400-e29b-41d4-a716-446655440000",
      "nickname": "小明",
      "avatar": "https://example.com/avatar.jpg"
    }
  }
}
```

### 错误响应

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "未授权，请先登录"
}
```

#### 403 Forbidden - 无权限
```json
{
  "success": false,
  "message": "无权访问该日记"
}
```

#### 404 Not Found - 不存在
```json
{
  "success": false,
  "message": "日记不存在"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "获取日记详情失败，请稍后重试"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 日记ID |
| user_id | UUID | 用户ID |
| title | String | 日记标题 |
| content | String | 日记完整内容 |
| mood | String | 心情 |
| weather | String | 天气 |
| images | Array | 图片URL数组 |
| tags | Array | 标签数组 |
| is_public | Boolean | 是否公开 |
| diary_date | String | 日记日期 |
| created_at | DateTime | 创建时间 |
| updated_at | DateTime | 更新时间 |
| author | Object | 作者信息 |

---

## 业务规则

1. 只能查看自己的日记或公开的日记
2. 返回日记的完整内容
3. author字段包含作者的基本信息
4. 如果是其他用户的公开日记，也可以查看
5. 私密日记只有作者本人可以查看

---

## 使用场景

- 日记详情页展示
- 查看完整日记内容
- 编辑日记前获取数据
- 查看他人公开日记

---

## 注意事项

1. 需要校验权限，防止越权访问
2. 返回完整的content字段
3. images数组可能为空
4. title可能为null
5. 建议实现图片预览功能

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`GET`
3. 输入URL：`http://localhost:3000/api/diary/{日记ID}`
4. 在Headers中添加：
   - `Authorization`: `Bearer {你的accessToken}`
5. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回完整的日记详情
- 包含author作者信息

---

## 相关接口

- [6.1 创建日记](./6.1-create-diary.md)
- [6.2 获取日记列表](./6.2-get-diary-list.md)
- [6.6 更新日记](./6.6-update-diary.md)
- [6.7 删除日记](./6.7-delete-diary.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-22 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-22
