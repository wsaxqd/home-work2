# API 2.2 - 更新用户信息

## 接口信息

- **接口名称**: 更新用户信息
- **请求方法**: PUT
- **请求路径**: `/api/users/profile`
- **需要认证**: 是

---

## 接口描述

用户更新自己的个人信息，包括昵称、头像、个人简介等。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Content-Type | String | 是 | application/json |
| Authorization | String | 是 | Bearer {accessToken} |

### Body参数
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| nickname | String | 否 | 用户昵称 | "小明" |
| avatar | String | 否 | 头像URL | "https://example.com/avatar.jpg" |
| bio | String | 否 | 个人简介 | "热爱创作的小学生" |

### 请求示例

```json
{
  "nickname": "小明的创作空间",
  "avatar": "https://example.com/avatar.jpg",
  "bio": "我喜欢画画和写故事"
}
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "message": "更新成功",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "phone": "13800138000",
    "nickname": "小明的创作空间",
    "avatar": "https://example.com/avatar.jpg",
    "bio": "我喜欢画画和写故事",
    "created_at": "2024-12-21T14:30:00.000Z",
    "updated_at": "2024-12-21T15:30:00.000Z"
  }
}
```

### 错误响应

#### 400 Bad Request - 参数错误
```json
{
  "success": false,
  "message": "昵称不能超过20个字符"
}
```

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "未授权，请先登录"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "更新失败，请稍后重试"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 用户唯一标识 |
| phone | String | 手机号 |
| nickname | String | 用户昵称 |
| avatar | String | 头像URL |
| bio | String | 个人简介 |
| created_at | DateTime | 注册时间 |
| updated_at | DateTime | 更新时间 |

---

## 业务规则

1. 用户只能更新自己的信息
2. 昵称长度不超过20个字符
3. 个人简介长度不超过200个字符
4. 头像URL需要是有效的URL格式
5. 所有字段都是可选的，只更新传入的字段
6. 更新后updated_at字段自动更新

---

## 使用场景

- 用户修改个人昵称
- 用户上传更新头像
- 用户编辑个人简介
- 用户完善个人资料

---

## 注意事项

1. 头像需要先通过上传接口上传后再更新URL
2. 建议在客户端对字段长度进行校验
3. 更新信息前建议先获取当前信息进行展示
4. 昵称和简介建议进行敏感词过滤

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`PUT`
3. 输入URL：`http://localhost:3000/api/users/profile`
4. 在Headers中添加：`Authorization: Bearer {accessToken}`
5. 选择Body标签
6. 选择`raw`和`JSON`格式
7. 输入请求体（见上方示例）
8. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回更新后的用户信息
- updated_at字段已更新

---

## 相关接口

- [2.1 获取当前用户信息](./2.1-get-profile.md)
- [10.4 上传头像](./10.4-upload-avatar.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-21 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-21
