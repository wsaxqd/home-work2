# API 2.3 - 获取用户统计数据

## 接口信息

- **接口名称**: 获取用户统计数据
- **请求方法**: GET
- **请求路径**: `/api/users/stats`
- **需要认证**: 是

---

## 接口描述

获取当前用户的各项统计数据，包括作品数量、粉丝数、关注数、获赞数等。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |

### Query参数
无

### 请求示例

```
GET /api/users/stats
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "data": {
    "works_count": 25,
    "published_works_count": 20,
    "draft_works_count": 5,
    "followers_count": 150,
    "following_count": 80,
    "likes_received": 520,
    "comments_received": 180,
    "diary_count": 45,
    "achievements_count": 12,
    "game_high_score": 9800,
    "total_study_time": 12600
  }
}
```

### 错误响应

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "未授权，请先登录"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "获取统计数据失败"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| works_count | Integer | 作品总数 |
| published_works_count | Integer | 已发布作品数 |
| draft_works_count | Integer | 草稿作品数 |
| followers_count | Integer | 粉丝数量 |
| following_count | Integer | 关注数量 |
| likes_received | Integer | 收到的点赞总数 |
| comments_received | Integer | 收到的评论总数 |
| diary_count | Integer | 日记总数 |
| achievements_count | Integer | 获得的成就数 |
| game_high_score | Integer | 游戏最高分 |
| total_study_time | Integer | 累计学习时长(秒) |

---

## 业务规则

1. 统计数据实时计算或从缓存读取
2. 仅统计当前用户的数据
3. 已删除的数据不计入统计
4. 学习时长单位为秒

---

## 使用场景

- 个人中心展示统计数据
- 用户成长数据展示
- 成就系统数据来源
- 排行榜数据计算

---

## 注意事项

1. 频繁调用可能影响性能，建议使用缓存
2. 统计数据可能存在延迟，不保证完全实时
3. 建议在页面加载时调用，而非频繁刷新

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`GET`
3. 输入URL：`http://localhost:3000/api/users/stats`
4. 在Headers中添加：`Authorization: Bearer {accessToken}`
5. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回完整的统计数据对象

---

## 相关接口

- [2.1 获取当前用户信息](./2.1-get-profile.md)
- [8.4 获取学习进度报告](./8.4-progress-report.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-21 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-21
