# API 8.2 - 提交评估

## 接口信息

- **接口名称**: 提交评估
- **请求方法**: POST
- **请求路径**: `/api/assessment/submit`
- **需要认证**: 是

---

## 接口描述

提交评估答案并获取评估结果，包括得分、正确率、知识点掌握情况等详细分析。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |
| Content-Type | String | 是 | application/json |

### Body参数
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| assessmentId | UUID | 是 | 评估ID(获取题目时返回) | "550e8400-e29b-41d4-a716-446655440000" |
| answers | Array | 是 | 答案列表 | 见下方示例 |
| timeSpent | Number | 否 | 答题用时(秒) | 300 |

### answers数组项
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| questionId | String | 是 | 题目ID |
| answer | String/Array | 是 | 答案(单选为字符串，多选为数组) |

### 请求示例

```json
{
  "assessmentId": "550e8400-e29b-41d4-a716-446655440000",
  "timeSpent": 300,
  "answers": [
    {
      "questionId": "q-001",
      "answer": "B"
    },
    {
      "questionId": "q-002",
      "answer": ["B", "D"]
    }
  ]
}
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "message": "评估提交成功",
  "data": {
    "resultId": "550e8400-e29b-41d4-a716-446655440001",
    "score": 85,
    "totalScore": 100,
    "accuracy": 0.85,
    "timeSpent": 300,
    "correctCount": 8,
    "wrongCount": 2,
    "totalCount": 10,
    "rank": "优秀",
    "details": [
      {
        "questionId": "q-001",
        "isCorrect": true,
        "userAnswer": "B",
        "correctAnswer": "B",
        "score": 10,
        "analysis": "回答正确！加法运算掌握良好。"
      },
      {
        "questionId": "q-002",
        "isCorrect": true,
        "userAnswer": ["B", "D"],
        "correctAnswer": ["B", "D"],
        "score": 15,
        "analysis": "回答正确！偶数概念理解准确。"
      }
    ],
    "knowledgePoints": [
      {
        "name": "基础加法",
        "mastery": 0.9,
        "level": "优秀"
      },
      {
        "name": "偶数识别",
        "mastery": 0.8,
        "level": "良好"
      }
    ],
    "suggestions": [
      "继续保持良好的学习状态",
      "可以尝试更高难度的题目"
    ]
  }
}
```

### 错误响应

#### 400 Bad Request - 参数错误
```json
{
  "success": false,
  "message": "评估ID无效或已过期"
}
```

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "请先登录"
}
```

#### 404 Not Found - 评估不存在
```json
{
  "success": false,
  "message": "评估不存在"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "提交失败，请稍后重试"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| resultId | UUID | 评估结果ID |
| score | Number | 得分 |
| totalScore | Number | 总分 |
| accuracy | Number | 正确率(0-1) |
| timeSpent | Number | 答题用时(秒) |
| correctCount | Number | 答对题数 |
| wrongCount | Number | 答错题数 |
| totalCount | Number | 总题数 |
| rank | String | 评级(优秀/良好/及格/不及格) |
| details | Array | 详细答题情况 |
| knowledgePoints | Array | 知识点掌握情况 |
| suggestions | Array | 学习建议 |

---

## 业务规则

1. assessmentId必须有效且属于当前用户
2. 答案数量必须与题目数量一致
3. 单选题answer为字符串，多选题为数组
4. 自动计算得分和正确率
5. 生成知识点掌握度分析
6. 提供个性化学习建议
7. 评估结果会保存到历史记录

---

## 使用场景

- 完成评估测试
- 查看测试结果和分析
- 获取学习建议
- 记录学习进度

---

## 注意事项

1. assessmentId有时效性，建议获取题目后尽快完成
2. 提交后无法修改答案
3. 答案格式必须正确匹配题目类型
4. 评估结果会影响后续推荐题目难度

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`POST`
3. 输入URL：`http://localhost:3000/api/assessment/submit`
4. 在Headers中添加：
   - Key: `Authorization`
   - Value: `Bearer {你的accessToken}`
   - Key: `Content-Type`
   - Value: `application/json`
5. 在Body中选择`raw`和`JSON`格式
6. 输入请求体（见上方示例）
7. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回评估结果和详细分析
- 包含知识点掌握情况和学习建议

---

## 相关接口

- [8.1 获取评估题目](./8.1-get-questions.md)
- [8.3 获取评估历史](./8.3-assessment-history.md)
- [8.4 获取学习进度报告](./8.4-progress-report.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-22 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-22
