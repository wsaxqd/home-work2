# API 3.3 - 创建作品

## 接口信息

- **接口名称**: 创建作品
- **请求方法**: POST
- **请求路径**: `/api/works`
- **需要认证**: 是

---

## 接口描述

用户创建新的作品（故事、音乐、绘画、诗歌），作品默认保存为草稿状态。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |
| Content-Type | String | 是 | application/json |

### Body参数
| 参数名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| type | String | 是 | 作品类型 | "story" |
| title | String | 是 | 作品标题 | "我的第一个故事" |
| content | String | 否 | 作品内容 | "从前有一座山..." |
| coverImage | String | 否 | 封面图片URL | "https://..." |
| audioUrl | String | 否 | 音频URL | "https://..." |

### 类型说明
**type枚举值**：
- `story` - 故事
- `music` - 音乐
- `art` - 绘画
- `poem` - 诗歌

### 请求示例

```json
{
  "type": "story",
  "title": "我的第一个故事",
  "content": "从前有一座山，山里有座庙...",
  "coverImage": "https://example.com/cover.jpg"
}
```

---

## 响应结果

### 成功响应 (201 Created)

```json
{
  "success": true,
  "message": "创建成功",
  "data": {
    "id": "660e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "type": "story",
    "title": "我的第一个故事",
    "content": "从前有一座山，山里有座庙...",
    "cover_image": "https://example.com/cover.jpg",
    "audio_url": null,
    "status": "draft",
    "like_count": 0,
    "comment_count": 0,
    "view_count": 0,
    "created_at": "2024-12-21T15:00:00.000Z",
    "updated_at": "2024-12-21T15:00:00.000Z",
    "published_at": null
  }
}
```

### 错误响应

#### 400 Bad Request
```json
{
  "success": false,
  "message": "请提供作品类型和标题"
}
```

#### 401 Unauthorized
```json
{
  "success": false,
  "message": "请先登录"
}
```

---

## 字段说明

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 作品ID |
| user_id | UUID | 创作者ID |
| type | String | 作品类型 |
| title | String | 作品标题 |
| content | String | 作品内容 |
| cover_image | String | 封面图片 |
| audio_url | String | 音频URL |
| status | String | 状态（draft/published/archived） |
| like_count | Integer | 点赞数 |
| comment_count | Integer | 评论数 |
| view_count | Integer | 浏览数 |
| published_at | DateTime | 发布时间（草稿为null） |

---

## 业务规则

1. 新创建的作品默认为草稿（draft）状态
2. 草稿状态的作品不会显示在公共画廊中
3. 需要调用发布接口才能公开作品
4. content、coverImage、audioUrl为可选字段
5. 根据作品类型，某些字段可能为必填：
   - story/poem: content必填
   - music: audioUrl必填
   - art: coverImage必填

---

## Postman测试

### 配置步骤
1. 方法：`POST`
2. URL：`http://localhost:3000/api/works`
3. Headers：`Authorization: Bearer {{accessToken}}`
4. Body → raw → JSON
5. 输入请求体
6. 发送请求

### 测试用例
```json
// 故事类型
{
  "type": "story",
  "title": "小兔子找萝卜",
  "content": "森林里住着一只可爱的小兔子...",
  "coverImage": "https://example.com/rabbit.jpg"
}

// 诗歌类型
{
  "type": "poem",
  "title": "春晓",
  "content": "春眠不觉晓，处处闻啼鸟..."
}
```

---

## 相关接口

- [3.6 更新作品](./3.6-update-work.md)
- [3.8 发布作品](./3.8-publish-work.md)
- [3.4 获取用户作品列表](./3.4-user-works.md)
- [10.1 上传图片](./10.1-upload-image.md)
- [10.3 上传音频](./10.3-upload-audio.md)

---

**维护者**: AI Assistant
**最后更新**: 2024-12-21
