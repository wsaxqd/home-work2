# API 3.2 - 获取热门作品

## 接口信息

- **接口名称**: 获取热门作品
- **请求方法**: GET
- **请求路径**: `/api/works/trending`
- **需要认证**: 否

---

## 接口描述

获取热门作品列表，基于综合热度算法（点赞数、评论数、浏览数、时间衰减等因素）排序。

---

## 请求参数

### Query参数
| 参数名 | 类型 | 必填 | 说明 | 默认值 |
|--------|------|------|------|--------|
| page | Integer | 否 | 页码 | 1 |
| pageSize | Integer | 否 | 每页数量 | 20 |
| type | String | 否 | 作品类型(story/music/art/poem) | 全部 |
| timeRange | String | 否 | 时间范围(day/week/month/all) | week |

### 请求示例

```
GET /api/works/trending?page=1&pageSize=20&timeRange=week
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440100",
      "title": "精彩的冒险故事",
      "type": "story",
      "cover_image": "https://example.com/cover1.jpg",
      "description": "一个充满想象力的故事",
      "likes_count": 350,
      "comments_count": 85,
      "views_count": 1520,
      "hot_score": 96.5,
      "created_at": "2024-12-19T10:00:00.000Z",
      "author": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "nickname": "创作大师",
        "avatar": "https://example.com/avatar1.jpg"
      }
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440101",
      "title": "动人的旋律",
      "type": "music",
      "cover_image": "https://example.com/cover2.jpg",
      "description": "AI创作的美妙音乐",
      "likes_count": 280,
      "comments_count": 62,
      "views_count": 1180,
      "hot_score": 92.3,
      "created_at": "2024-12-18T14:20:00.000Z",
      "author": {
        "id": "550e8400-e29b-41d4-a716-446655440002",
        "nickname": "音乐小天才",
        "avatar": "https://example.com/avatar2.jpg"
      }
    }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

### 错误响应

#### 400 Bad Request - 参数错误
```json
{
  "success": false,
  "message": "无效的时间范围参数"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "获取热门作品失败"
}
```

---

## 字段说明

### 响应字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 作品ID |
| title | String | 作品标题 |
| type | String | 作品类型 |
| cover_image | String | 封面图片URL |
| description | String | 作品描述 |
| likes_count | Integer | 点赞数 |
| comments_count | Integer | 评论数 |
| views_count | Integer | 浏览数 |
| hot_score | Float | 热度分数(0-100) |
| created_at | DateTime | 创建时间 |
| author | Object | 作者信息 |

---

## 业务规则

1. 热度分数综合考虑：点赞数、评论数、浏览数、时间衰减
2. 时间范围：day(24小时)、week(7天)、month(30天)、all(全部)
3. 仅返回已发布的作品
4. 热度榜单每小时更新一次
5. 新作品有一定的流量扶持

---

## 热度计算公式

```
hot_score = (likes * 3 + comments * 5 + views * 0.1) * time_decay_factor
time_decay_factor = 1 / (1 + (current_time - created_time) / decay_constant)
```

---

## 使用场景

- 首页热门推荐
- 发现页热门作品
- 热榜排行展示
- 优质内容曝光

---

## 注意事项

1. 热门数据建议使用缓存，避免频繁计算
2. 时间衰减因子需要定期调整
3. 可以对不同作品类型使用不同的权重
4. 注意防止刷量行为

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`GET`
3. 输入URL：`http://localhost:3000/api/works/trending?timeRange=week`
4. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回按热度排序的作品列表
- 包含hot_score字段

---

## 相关接口

- [3.1 获取公开作品画廊](./3.1-works-gallery.md)
- [3.5 获取作品详情](./3.5-work-detail.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-21 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-21
