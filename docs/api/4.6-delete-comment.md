# API 4.6 - 删除评论

## 接口信息

- **接口名称**: 删除评论
- **请求方法**: DELETE
- **请求路径**: `/api/community/comments/:id`
- **需要认证**: 是

---

## 接口描述

删除指定评论，仅评论作者本人或作品作者可以删除。删除操作为软删除。

---

## 请求参数

### Header参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 是 | Bearer {accessToken} |

### Path参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | UUID | 是 | 评论ID |

### 请求示例

```
DELETE /api/community/comments/550e8400-e29b-41d4-a716-446655440201
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## 响应结果

### 成功响应 (200 OK)

```json
{
  "success": true,
  "message": "评论已删除"
}
```

### 错误响应

#### 401 Unauthorized - 未授权
```json
{
  "success": false,
  "message": "未授权，请先登录"
}
```

#### 403 Forbidden - 无权操作
```json
{
  "success": false,
  "message": "无权删除该评论"
}
```

#### 404 Not Found - 评论不存在
```json
{
  "success": false,
  "message": "评论不存在"
}
```

#### 500 Internal Server Error - 服务器错误
```json
{
  "success": false,
  "message": "删除评论失败"
}
```

---

## 字段说明

### 响应字段
无特殊字段，仅返回操作状态信息。

---

## 业务规则

1. 评论作者本人可以删除自己的评论
2. 作品作者可以删除作品下的任何评论
3. 删除操作为软删除，数据仍保留在数据库
4. 删除评论后，作品评论数-1
5. 如果删除的是父评论，其所有回复也会被删除
6. 删除评论不发送通知

---

## 使用场景

- 删除不当评论
- 管理作品评论区
- 撤回误发评论
- 清理垃圾评论

---

## 注意事项

1. 删除父评论会连带删除所有回复
2. 建议添加删除确认提示
3. 删除操作不可恢复
4. 作品作者删除他人评论需谨慎

---

## Postman测试

### 配置步骤
1. 创建新请求
2. 选择方法：`DELETE`
3. 输入URL：`http://localhost:3000/api/community/comments/{commentId}`
4. 在Headers中添加：`Authorization: Bearer {accessToken}`
5. 点击`Send`发送请求

### 预期结果
- 状态码：200
- 返回删除成功信息
- 评论不再显示在列表中
- 作品评论数减少

---

## 相关接口

- [4.3 发表评论](./4.3-create-comment.md)
- [4.4 获取评论列表](./4.4-get-comments.md)

---

## 更新记录

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2024-12-21 | 初始版本 |

---

**维护者**: AI Assistant
**最后更新**: 2024-12-21
