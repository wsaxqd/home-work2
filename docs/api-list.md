# å¯è’™ä¹‹å…‰ - APIæ¥å£æ¸…å•

## ğŸ“ æ–‡æ¡£è¯´æ˜
æœ¬æ–‡æ¡£ç½—åˆ—äº†"å¯è’™ä¹‹å…‰"AIé€šç”¨æ•™è‚²å¹³å°çš„æ‰€æœ‰APIæ¥å£ã€‚

**åŸºç¡€URL**: `http://localhost:3000`

**è®¤è¯æ–¹å¼**: Bearer Token (JWT)

---

## APIæ¨¡å—æ¦‚è§ˆ

| æ¨¡å—ç¼–å· | æ¨¡å—åç§° | è·¯ç”±å‰ç¼€ | APIæ•°é‡ | è¯´æ˜ |
|---------|---------|---------|---------|------|
| 1 | è®¤è¯æ¨¡å— | `/api/auth` | 5 | ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€é‰´æƒ |
| 2 | ç”¨æˆ·æ¨¡å— | `/api/users` | 8 | ç”¨æˆ·ä¿¡æ¯ã€å…³æ³¨å…³ç³» |
| 3 | ä½œå“æ¨¡å— | `/api/works` | 9 | åˆ›ä½œä½œå“ç®¡ç† |
| 4 | ç¤¾åŒºæ¨¡å— | `/api/community` | 8 | ç‚¹èµã€è¯„è®ºã€å¿ƒæ„¿å¢™ |
| 5 | æ¸¸æˆæ¨¡å— | `/api/games` | 5 | AIäº’åŠ¨æ¸¸æˆ |
| 6 | æ—¥è®°æ¨¡å— | `/api/diary` | 7 | æˆé•¿æ—¥è®° |
| 7 | AIæœåŠ¡æ¨¡å— | `/api/ai` | 8 | AIå¯¹è¯ã€ç”Ÿæˆã€è¯†åˆ« |
| 8 | è¯„ä¼°æ¨¡å— | `/api/assessment` | 5 | çŸ¥è¯†è¯„ä¼°æµ‹è¯• |
| 9 | é€šçŸ¥æ¨¡å— | `/api/notifications` | 6 | æ¶ˆæ¯é€šçŸ¥ |
| 10 | ä¸Šä¼ æ¨¡å— | `/api/upload` | 5 | æ–‡ä»¶ä¸Šä¼  |

**APIæ€»æ•°**: 66ä¸ª

---

## 1. è®¤è¯æ¨¡å— (Auth)

**åŸºç¡€è·¯å¾„**: `/api/auth`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 1.1 | POST | `/register` | - | ç”¨æˆ·æ³¨å†Œ | [è¯¦ç»†æ–‡æ¡£](./api/1.1-register.md) |
| 1.2 | POST | `/login` | - | ç”¨æˆ·ç™»å½• | [è¯¦ç»†æ–‡æ¡£](./api/1.2-login.md) |
| 1.3 | POST | `/logout` | âœ“ | é€€å‡ºç™»å½• | [è¯¦ç»†æ–‡æ¡£](./api/1.3-logout.md) |
| 1.4 | POST | `/refresh-token` | - | åˆ·æ–°ä»¤ç‰Œ | [è¯¦ç»†æ–‡æ¡£](./api/1.4-refresh-token.md) |
| 1.5 | POST | `/change-password` | âœ“ | ä¿®æ”¹å¯†ç  | [è¯¦ç»†æ–‡æ¡£](./api/1.5-change-password.md) |

---

## 2. ç”¨æˆ·æ¨¡å— (Users)

**åŸºç¡€è·¯å¾„**: `/api/users`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 2.1 | GET | `/profile` | âœ“ | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ | [è¯¦ç»†æ–‡æ¡£](./api/2.1-get-profile.md) |
| 2.2 | PUT | `/profile` | âœ“ | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | [è¯¦ç»†æ–‡æ¡£](./api/2.2-update-profile.md) |
| 2.3 | GET | `/stats` | âœ“ | è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ® | [è¯¦ç»†æ–‡æ¡£](./api/2.3-user-stats.md) |
| 2.4 | GET | `/followers` | âœ“ | è·å–ç²‰ä¸åˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/2.4-followers.md) |
| 2.5 | GET | `/following` | âœ“ | è·å–å…³æ³¨åˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/2.5-following.md) |
| 2.6 | GET | `/:id` | å¯é€‰ | è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯ | [è¯¦ç»†æ–‡æ¡£](./api/2.6-get-user-by-id.md) |
| 2.7 | POST | `/:id/follow` | âœ“ | å…³æ³¨ç”¨æˆ· | [è¯¦ç»†æ–‡æ¡£](./api/2.7-follow-user.md) |
| 2.8 | DELETE | `/:id/follow` | âœ“ | å–æ¶ˆå…³æ³¨ | [è¯¦ç»†æ–‡æ¡£](./api/2.8-unfollow-user.md) |

---

## 3. ä½œå“æ¨¡å— (Works)

**åŸºç¡€è·¯å¾„**: `/api/works`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 3.1 | GET | `/gallery` | - | è·å–å…¬å¼€ä½œå“ç”»å»Š | [è¯¦ç»†æ–‡æ¡£](./api/3.1-works-gallery.md) |
| 3.2 | GET | `/trending` | - | è·å–çƒ­é—¨ä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/3.2-trending-works.md) |
| 3.3 | POST | `/` | âœ“ | åˆ›å»ºä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/3.3-create-work.md) |
| 3.4 | GET | `/` | âœ“ | è·å–ç”¨æˆ·ä½œå“åˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/3.4-user-works.md) |
| 3.5 | GET | `/:id` | å¯é€‰ | è·å–ä½œå“è¯¦æƒ… | [è¯¦ç»†æ–‡æ¡£](./api/3.5-work-detail.md) |
| 3.6 | PUT | `/:id` | âœ“ | æ›´æ–°ä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/3.6-update-work.md) |
| 3.7 | DELETE | `/:id` | âœ“ | åˆ é™¤ä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/3.7-delete-work.md) |
| 3.8 | POST | `/:id/publish` | âœ“ | å‘å¸ƒä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/3.8-publish-work.md) |
| 3.9 | POST | `/:id/unpublish` | âœ“ | å–æ¶ˆå‘å¸ƒ | [è¯¦ç»†æ–‡æ¡£](./api/3.9-unpublish-work.md) |

---

## 4. ç¤¾åŒºæ¨¡å— (Community)

**åŸºç¡€è·¯å¾„**: `/api/community`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 4.1 | POST | `/works/:id/like` | âœ“ | ç‚¹èµä½œå“ | [è¯¦ç»†æ–‡æ¡£](./api/4.1-like-work.md) |
| 4.2 | DELETE | `/works/:id/like` | âœ“ | å–æ¶ˆç‚¹èµ | [è¯¦ç»†æ–‡æ¡£](./api/4.2-unlike-work.md) |
| 4.3 | POST | `/works/:id/comments` | âœ“ | å‘è¡¨è¯„è®º | [è¯¦ç»†æ–‡æ¡£](./api/4.3-create-comment.md) |
| 4.4 | GET | `/works/:id/comments` | - | è·å–è¯„è®ºåˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/4.4-get-comments.md) |
| 4.5 | GET | `/comments/:id/replies` | - | è·å–è¯„è®ºå›å¤ | [è¯¦ç»†æ–‡æ¡£](./api/4.5-get-replies.md) |
| 4.6 | DELETE | `/comments/:id` | âœ“ | åˆ é™¤è¯„è®º | [è¯¦ç»†æ–‡æ¡£](./api/4.6-delete-comment.md) |
| 4.7 | POST | `/wishes` | âœ“ | å‘å¸ƒå¿ƒæ„¿ | [è¯¦ç»†æ–‡æ¡£](./api/4.7-create-wish.md) |
| 4.8 | GET | `/wishes` | - | è·å–å¿ƒæ„¿å¢™ | [è¯¦ç»†æ–‡æ¡£](./api/4.8-get-wishes.md) |
| 4.9 | POST | `/wishes/:id/support` | âœ“ | æ”¯æŒå¿ƒæ„¿ | [è¯¦ç»†æ–‡æ¡£](./api/4.9-support-wish.md) |
| 4.10 | PUT | `/wishes/:id/status` | âœ“ | æ›´æ–°å¿ƒæ„¿çŠ¶æ€ | [è¯¦ç»†æ–‡æ¡£](./api/4.10-update-wish-status.md) |

---

## 5. æ¸¸æˆæ¨¡å— (Games)

**åŸºç¡€è·¯å¾„**: `/api/games`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 5.1 | POST | `/score` | âœ“ | ä¿å­˜æ¸¸æˆæˆç»© | [è¯¦ç»†æ–‡æ¡£](./api/5.1-save-score.md) |
| 5.2 | GET | `/progress` | âœ“ | è·å–æ¸¸æˆè¿›åº¦ | [è¯¦ç»†æ–‡æ¡£](./api/5.2-game-progress.md) |
| 5.3 | GET | `/leaderboard` | - | è·å–æ’è¡Œæ¦œ | [è¯¦ç»†æ–‡æ¡£](./api/5.3-leaderboard.md) |
| 5.4 | GET | `/rank` | âœ“ | è·å–ç”¨æˆ·æ’å | [è¯¦ç»†æ–‡æ¡£](./api/5.4-user-rank.md) |
| 5.5 | GET | `/history` | âœ“ | è·å–æ¸¸æˆå†å²è®°å½• | [è¯¦ç»†æ–‡æ¡£](./api/5.5-game-history.md) |

---

## 6. æ—¥è®°æ¨¡å— (Diary)

**åŸºç¡€è·¯å¾„**: `/api/diary`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 6.1 | POST | `/` | âœ“ | åˆ›å»ºæ—¥è®° | [è¯¦ç»†æ–‡æ¡£](./api/6.1-create-diary.md) |
| 6.2 | GET | `/` | âœ“ | è·å–æ—¥è®°åˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/6.2-diary-list.md) |
| 6.3 | GET | `/mood-stats` | âœ“ | è·å–å¿ƒæƒ…ç»Ÿè®¡ | [è¯¦ç»†æ–‡æ¡£](./api/6.3-mood-stats.md) |
| 6.4 | GET | `/calendar` | âœ“ | è·å–æ—¥å†æ•°æ® | [è¯¦ç»†æ–‡æ¡£](./api/6.4-diary-calendar.md) |
| 6.5 | GET | `/:id` | âœ“ | è·å–æ—¥è®°è¯¦æƒ… | [è¯¦ç»†æ–‡æ¡£](./api/6.5-diary-detail.md) |
| 6.6 | PUT | `/:id` | âœ“ | æ›´æ–°æ—¥è®° | [è¯¦ç»†æ–‡æ¡£](./api/6.6-update-diary.md) |
| 6.7 | DELETE | `/:id` | âœ“ | åˆ é™¤æ—¥è®° | [è¯¦ç»†æ–‡æ¡£](./api/6.7-delete-diary.md) |

---

## 7. AIæœåŠ¡æ¨¡å— (AI)

**åŸºç¡€è·¯å¾„**: `/api/ai`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 7.1 | POST | `/chat` | âœ“ | AIå¯¹è¯ | [è¯¦ç»†æ–‡æ¡£](./api/7.1-ai-chat.md) |
| 7.2 | POST | `/story` | âœ“ | AIç”Ÿæˆæ•…äº‹ | [è¯¦ç»†æ–‡æ¡£](./api/7.2-generate-story.md) |
| 7.3 | POST | `/image/recognize` | âœ“ | å›¾åƒè¯†åˆ« | [è¯¦ç»†æ–‡æ¡£](./api/7.3-recognize-image.md) |
| 7.4 | POST | `/emotion/analyze` | âœ“ | æƒ…æ„Ÿåˆ†æ | [è¯¦ç»†æ–‡æ¡£](./api/7.4-analyze-emotion.md) |
| 7.5 | POST | `/voice/to-text` | âœ“ | è¯­éŸ³è½¬æ–‡å­— | [è¯¦ç»†æ–‡æ¡£](./api/7.5-speech-to-text.md) |
| 7.6 | POST | `/voice/to-speech` | âœ“ | æ–‡å­—è½¬è¯­éŸ³ | [è¯¦ç»†æ–‡æ¡£](./api/7.6-text-to-speech.md) |
| 7.7 | GET | `/history` | âœ“ | è·å–AIä½¿ç”¨å†å² | [è¯¦ç»†æ–‡æ¡£](./api/7.7-ai-history.md) |
| 7.8 | GET | `/stats` | âœ“ | è·å–AIä½¿ç”¨ç»Ÿè®¡ | [è¯¦ç»†æ–‡æ¡£](./api/7.8-ai-stats.md) |

---

## 8. è¯„ä¼°æ¨¡å— (Assessment)

**åŸºç¡€è·¯å¾„**: `/api/assessment`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 8.1 | GET | `/questions` | âœ“ | è·å–è¯„ä¼°é¢˜ç›® | [è¯¦ç»†æ–‡æ¡£](./api/8.1-get-questions.md) |
| 8.2 | POST | `/submit` | âœ“ | æäº¤è¯„ä¼° | [è¯¦ç»†æ–‡æ¡£](./api/8.2-submit-assessment.md) |
| 8.3 | GET | `/history` | âœ“ | è·å–è¯„ä¼°å†å² | [è¯¦ç»†æ–‡æ¡£](./api/8.3-assessment-history.md) |
| 8.4 | GET | `/report` | âœ“ | è·å–å­¦ä¹ è¿›åº¦æŠ¥å‘Š | [è¯¦ç»†æ–‡æ¡£](./api/8.4-progress-report.md) |
| 8.5 | GET | `/radar` | âœ“ | è·å–èƒ½åŠ›é›·è¾¾å›¾æ•°æ® | [è¯¦ç»†æ–‡æ¡£](./api/8.5-skill-radar.md) |

---

## 9. é€šçŸ¥æ¨¡å— (Notifications)

**åŸºç¡€è·¯å¾„**: `/api/notifications`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 9.1 | GET | `/` | âœ“ | è·å–é€šçŸ¥åˆ—è¡¨ | [è¯¦ç»†æ–‡æ¡£](./api/9.1-notifications-list.md) |
| 9.2 | GET | `/unread-count` | âœ“ | è·å–æœªè¯»é€šçŸ¥æ•°é‡ | [è¯¦ç»†æ–‡æ¡£](./api/9.2-unread-count.md) |
| 9.3 | PUT | `/:id/read` | âœ“ | æ ‡è®°å•ä¸ªé€šçŸ¥ä¸ºå·²è¯» | [è¯¦ç»†æ–‡æ¡£](./api/9.3-mark-as-read.md) |
| 9.4 | PUT | `/read-all` | âœ“ | æ ‡è®°æ‰€æœ‰é€šçŸ¥ä¸ºå·²è¯» | [è¯¦ç»†æ–‡æ¡£](./api/9.4-mark-all-as-read.md) |
| 9.5 | DELETE | `/:id` | âœ“ | åˆ é™¤å•ä¸ªé€šçŸ¥ | [è¯¦ç»†æ–‡æ¡£](./api/9.5-delete-notification.md) |
| 9.6 | DELETE | `/clear/read` | âœ“ | æ¸…ç©ºå·²è¯»é€šçŸ¥ | [è¯¦ç»†æ–‡æ¡£](./api/9.6-clear-read-notifications.md) |

---

## 10. ä¸Šä¼ æ¨¡å— (Upload)

**åŸºç¡€è·¯å¾„**: `/api/upload`

| ç¼–å· | æ–¹æ³• | è·¯å¾„ | é‰´æƒ | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|------|------|
| 10.1 | POST | `/image` | âœ“ | ä¸Šä¼ å•ä¸ªå›¾ç‰‡ | [è¯¦ç»†æ–‡æ¡£](./api/10.1-upload-image.md) |
| 10.2 | POST | `/images` | âœ“ | æ‰¹é‡ä¸Šä¼ å›¾ç‰‡ | [è¯¦ç»†æ–‡æ¡£](./api/10.2-upload-images.md) |
| 10.3 | POST | `/audio` | âœ“ | ä¸Šä¼ éŸ³é¢‘ | [è¯¦ç»†æ–‡æ¡£](./api/10.3-upload-audio.md) |
| 10.4 | POST | `/avatar` | âœ“ | ä¸Šä¼ å¤´åƒ | [è¯¦ç»†æ–‡æ¡£](./api/10.4-upload-avatar.md) |
| 10.5 | DELETE | `/` | âœ“ | åˆ é™¤æ–‡ä»¶ | [è¯¦ç»†æ–‡æ¡£](./api/10.5-delete-file.md) |

---

## ğŸ” è®¤è¯è¯´æ˜

### éœ€è¦è®¤è¯çš„æ¥å£
å¤§å¤šæ•°APIéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦JWT Tokenï¼š

```http
Authorization: Bearer <your_access_token>
```

### Tokenè·å–
1. é€šè¿‡ `POST /api/auth/register` æ³¨å†Œè´¦å·
2. é€šè¿‡ `POST /api/auth/login` ç™»å½•è·å–Token
3. Tokenè¿‡æœŸæ—¶é€šè¿‡ `POST /api/auth/refresh-token` åˆ·æ–°

### å¯é€‰è®¤è¯çš„æ¥å£
éƒ¨åˆ†æ¥å£æ”¯æŒå¯é€‰è®¤è¯ï¼ˆoptionalAuthï¼‰ï¼Œå¦‚ï¼š
- `GET /api/users/:id` - è·å–ç”¨æˆ·ä¿¡æ¯
- `GET /api/works/:id` - è·å–ä½œå“è¯¦æƒ…

---

## ğŸ“Š ç»Ÿä¸€å“åº”æ ¼å¼

### æˆåŠŸå“åº”
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... }
}
```

### åˆ†é¡µå“åº”
```json
{
  "success": true,
  "data": [ ... ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

### é”™è¯¯å“åº”
```json
{
  "success": false,
  "message": "é”™è¯¯ä¿¡æ¯",
  "error": { ... }
}
```

---

## ğŸš€ çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒï¼ˆæœªç™»å½•æˆ–Tokenæ— æ•ˆï¼‰ |
| 403 | ç¦æ­¢è®¿é—®ï¼ˆæ— æƒé™ï¼‰ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸ“ æŸ¥è¯¢å‚æ•°è¯´æ˜

### é€šç”¨åˆ†é¡µå‚æ•°
```
page: é¡µç ï¼ˆé»˜è®¤1ï¼‰
pageSize: æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤20ï¼‰
```

### é€šç”¨æ’åºå‚æ•°
```
sortBy: æ’åºå­—æ®µ
order: æ’åºæ–¹å¼ï¼ˆasc/descï¼‰
```

---

## ğŸ”„ æ•°æ®ç±»å‹æšä¸¾

### ä½œå“ç±»å‹ (work_type)
- `story` - æ•…äº‹
- `music` - éŸ³ä¹
- `art` - ç»˜ç”»
- `poem` - è¯—æ­Œ

### ä½œå“çŠ¶æ€ (work_status)
- `draft` - è‰ç¨¿
- `published` - å·²å‘å¸ƒ
- `archived` - å·²å½’æ¡£

### æ¸¸æˆç±»å‹ (game_type)
- `image_recognition` - å›¾åƒè¯†åˆ«
- `expression_recognition` - è¡¨æƒ…è¯†åˆ«
- `music_rhythm` - éŸ³ä¹èŠ‚å¥
- `story_continuation` - æ•…äº‹æ¥é¾™

### å¿ƒæƒ…ç±»å‹ (mood_type)
- `happy` - å¼€å¿ƒ
- `sad` - éš¾è¿‡
- `excited` - å…´å¥‹
- `calm` - å¹³é™
- `anxious` - ç„¦è™‘
- `angry` - ç”Ÿæ°”
- `surprised` - æƒŠè®¶

### é€šçŸ¥ç±»å‹ (notification_type)
- `system` - ç³»ç»Ÿé€šçŸ¥
- `comment` - è¯„è®ºé€šçŸ¥
- `like` - ç‚¹èµé€šçŸ¥
- `follow` - å…³æ³¨é€šçŸ¥
- `achievement` - æˆå°±é€šçŸ¥

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2024-12-21
**ç»´æŠ¤è€…**: AI Assistant
