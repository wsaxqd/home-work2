# 阿里云 DNS 配置指南 - qmzgai.com

## 📌 前置要求

- 已在阿里云购买域名 `qmzgai.com`
- 已准备好服务器公网 IP 地址
- 域名实名认证已完成

---

## 🔧 配置步骤

### 第一步：登录阿里云控制台

1. 访问：https://dns.console.aliyun.com/
2. 登录阿里云账号
3. 点击左侧菜单「域名解析」

### 第二步：选择域名

1. 在域名列表中找到 `qmzgai.com`
2. 点击右侧「解析设置」按钮

### 第三步：添加 A 记录（主域名）

点击「添加记录」，填写以下信息：

| 字段 | 值 | 说明 |
|------|-----|------|
| **记录类型** | `A` | IPv4 地址记录 |
| **主机记录** | `@` | 代表主域名 qmzgai.com |
| **解析线路** | `默认` | 全球用户都使用此配置 |
| **记录值** | `你的服务器IP` | 例如：123.45.67.89 |
| **TTL** | `10分钟` | 推荐值，便于快速生效 |

**配置示例：**
```
记录类型：A
主机记录：@
记录值：123.45.67.89
TTL：600（10分钟）
```

点击「确定」保存。

### 第四步：添加 A 记录（www 子域名）

再次点击「添加记录」：

| 字段 | 值 | 说明 |
|------|-----|------|
| **记录类型** | `A` | IPv4 地址记录 |
| **主机记录** | `www` | 代表 www.qmzgai.com |
| **解析线路** | `默认` | 全球用户都使用此配置 |
| **记录值** | `你的服务器IP` | 与上一步相同 |
| **TTL** | `10分钟` | 推荐值 |

**配置示例：**
```
记录类型：A
主机记录：www
记录值：123.45.67.89
TTL：600（10分钟）
```

点击「确定」保存。

### 第五步：添加 API 子域名（可选）

如果你的 API 需要单独的域名：

| 字段 | 值 | 说明 |
|------|-----|------|
| **记录类型** | `CNAME` | 别名记录 |
| **主机记录** | `api` | 代表 api.qmzgai.com |
| **解析线路** | `默认` | 全球用户都使用此配置 |
| **记录值** | `qmzgai.com` | 指向主域名 |
| **TTL** | `10分钟` | 推荐值 |

**或者使用 A 记录：**
```
记录类型：A
主机记录：api
记录值：123.45.67.89
TTL：600（10分钟）
```

### 第六步：添加 TXT 记录（安全防护）

| 字段 | 值 | 说明 |
|------|-----|------|
| **记录类型** | `TXT` | 文本记录 |
| **主机记录** | `@` | 主域名 |
| **解析线路** | `默认` | 全球用户都使用此配置 |
| **记录值** | `v=spf1 -all` | 防止邮件伪造 |
| **TTL** | `10分钟` | 推荐值 |

---

## ✅ 配置完成后的记录列表

配置完成后，你的 DNS 记录应该如下：

| 主机记录 | 记录类型 | 记录值 | TTL |
|---------|---------|--------|-----|
| @ | A | 123.45.67.89 | 600 |
| www | A | 123.45.67.89 | 600 |
| api | A | 123.45.67.89 | 600 |
| @ | TXT | v=spf1 -all | 600 |

---

## 🔍 验证 DNS 配置

### 方法1：使用命令行工具

**Windows（PowerShell）：**
```powershell
# 查询主域名
nslookup qmzgai.com

# 查询 www 子域名
nslookup www.qmzgai.com

# 查询 API 子域名
nslookup api.qmzgai.com
```

**Linux/Mac（Terminal）：**
```bash
# 查询主域名
dig qmzgai.com

# 查询 www 子域名
dig www.qmzgai.com

# 查询 API 子域名
dig api.qmzgai.com
```

### 方法2：使用在线工具

访问：https://tool.chinaz.com/dns/
输入 `qmzgai.com` 查看解析结果

### 预期结果

```
qmzgai.com        ->  123.45.67.89
www.qmzgai.com    ->  123.45.67.89
api.qmzgai.com    ->  123.45.67.89
```

---

## ⏱️ DNS 生效时间

- **阿里云 DNS 服务器更新：** 10 分钟内
- **全球 DNS 缓存刷新：** 最长 24-48 小时
- **建议等待时间：** 30 分钟后开始验证

**加速生效方法：**
1. 清除本地 DNS 缓存：
   ```bash
   # Windows
   ipconfig /flushdns

   # Mac
   sudo dscacheutil -flushcache

   # Linux
   sudo systemd-resolve --flush-caches
   ```

---

## 🛡️ 安全建议

### 1. 启用 DNSSEC（域名安全扩展）

在阿里云 DNS 控制台：
1. 点击域名右侧「管理」
2. 找到「DNSSEC 设置」
3. 点击「启用 DNSSEC」

### 2. 设置访问控制

1. 在阿里云控制台设置子账号权限
2. 开启操作日志记录
3. 启用两步验证

### 3. 监控告警

1. 设置 DNS 解析异常告警
2. 配置域名到期提醒
3. 监控解析请求量

---

## ❌ 常见问题

### Q1：DNS 配置后无法访问？

**原因：**
- DNS 还未完全生效（等待 30 分钟）
- 服务器防火墙未开放 80/443 端口
- Nginx 未正确配置

**解决方法：**
```bash
# 1. 检查服务器端口
sudo netstat -tlnp | grep :80
sudo netstat -tlnp | grep :443

# 2. 开放防火墙端口
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# 3. 检查 Nginx 状态
sudo systemctl status nginx
```

### Q2：www 可以访问，但主域名不行？

**原因：** @ 记录未配置或配置错误

**解决方法：** 检查 @ 记录是否正确添加

### Q3：国内访问慢？

**原因：** 服务器在国外或未使用 CDN

**解决方法：**
1. 使用阿里云 CDN 加速
2. 配置国内外分线路解析
3. 使用国内服务器

---

## 📞 技术支持

- 阿里云客服：95187
- 工单系统：https://workorder.console.aliyun.com/
- 文档中心：https://help.aliyun.com/

---

**配置完成时间：** 2026-01-28
**文档版本：** v1.0
