# 启蒙之光 - 功能完善计划表

## 📋 项目当前状态
- **整体完成度**: 88%
- **核心功能**: 95% 完成
- **辅助功能**: 70% 完成
- **前后端对应**: 良好

---

## 🎯 功能完善优先级计划

### 阶段一: 紧急修复 (P0 - 立即完成)
**目标**: 修复影响用户体验的关键问题
**预计工作量**: 2-3天

#### 1.1 配置未使用的路由 ⚡
**优先级**: P0 - 最高
**工作量**: 0.5天
**影响**: 已完成的页面无法访问

**任务清单**:
- [ ] 在 `app/src/App.tsx` 中添加 `/skill-tree` 路由
- [ ] 在 `app/src/App.tsx` 中添加 `/today-tasks` 路由
- [ ] 测试路由跳转是否正常

**技术细节**:
```typescript
// 需要在 App.tsx 中添加
<Route path="/skill-tree" element={
  <ProtectedRoute>
    <SkillTree />
  </ProtectedRoute>
} />

<Route path="/today-tasks" element={
  <ProtectedRoute>
    <TodayTasks />
  </ProtectedRoute>
} />
```

**验收标准**:
- 可以通过导航访问技能树页面
- 可以通过导航访问今日任务页面
- 页面数据正常加载

---

#### 1.2 运行数据库迁移 ⚡
**优先级**: P0 - 最高
**工作量**: 0.5天
**影响**: 短信验证码功能无法使用

**任务清单**:
- [ ] 运行 `041_create_sms_verify_codes.ts` 迁移
- [ ] 验证数据库表创建成功
- [ ] 测试短信验证码功能

**执行命令**:
```bash
cd server
npm run migrate
```

**验收标准**:
- `sms_verify_codes` 表创建成功
- `sms_send_logs` 表创建成功
- 短信发送功能正常

---

### 阶段二: 核心功能完善 (P1 - 高优先级)
**目标**: 完善影响核心用户体验的功能
**预计工作量**: 5-7天

#### 2.1 创建用户设置页面 🔧
**优先级**: P1 - 高
**工作量**: 2天
**影响**: 用户无法管理个人设置

**任务清单**:
- [ ] 创建 `app/src/pages/Settings.tsx` 页面
- [ ] 实现账户设置功能
  - [ ] 修改昵称
  - [ ] 修改头像
  - [ ] 修改个人简介
- [ ] 实现偏好设置功能
  - [ ] 语言选择
  - [ ] 主题设置(明暗模式)
  - [ ] 字体大小
- [ ] 实现通知设置功能
  - [ ] 系统通知开关
  - [ ] 学习提醒开关
  - [ ] 消息推送开关
- [ ] 添加路由配置
- [ ] 在个人中心添加入口

**后端API**:
```typescript
// 需要扩展现有API
PUT /api/users/profile - 更新用户信息
PUT /api/users/settings - 更新用户设置
GET /api/users/settings - 获取用户设置
```

**页面结构**:
```
设置页面
├── 账户设置
│   ├── 头像上传
│   ├── 昵称修改
│   └── 个人简介
├── 偏好设置
│   ├── 语言选择
│   ├── 主题模式
│   └── 字体大小
├── 通知设置
│   ├── 系统通知
│   ├── 学习提醒
│   └── 消息推送
└── 账户安全
    └── 跳转到账户安全页面
```

**验收标准**:
- 可以修改个人信息
- 设置可以保存并生效
- 界面友好易用

---

#### 2.2 创建账户安全页面 🔒
**优先级**: P1 - 高
**工作量**: 1.5天
**影响**: 用户无法管理账户安全

**任务清单**:
- [ ] 创建 `app/src/pages/AccountSecurity.tsx` 页面
- [ ] 实现密码修改功能
  - [ ] 输入旧密码
  - [ ] 输入新密码
  - [ ] 确认新密码
- [ ] 实现手机号绑定/更换
  - [ ] 发送验证码
  - [ ] 验证验证码
  - [ ] 绑定新手机号
- [ ] 实现邮箱绑定/更换
- [ ] 显示登录设备列表
- [ ] 添加退出所有设备功能
- [ ] 添加路由配置

**后端API**:
```typescript
// 已存在
POST /api/auth/change-password - 修改密码

// 需要新增
POST /api/users/bind-phone - 绑定手机号
POST /api/users/bind-email - 绑定邮箱
GET /api/users/login-devices - 获取登录设备
POST /api/users/logout-all - 退出所有设备
```

**验收标准**:
- 可以修改密码
- 可以绑定/更换手机号和邮箱
- 可以查看登录设备
- 可以退出所有设备

---

#### 2.3 完善密码找回流程 🔑
**优先级**: P1 - 高
**工作量**: 1天
**影响**: 用户忘记密码无法找回

**任务清单**:
- [ ] 创建 `app/src/pages/PasswordReset.tsx` 页面
- [ ] 实现找回流程
  - [ ] 步骤1: 输入手机号/邮箱
  - [ ] 步骤2: 发送验证码
  - [ ] 步骤3: 验证验证码
  - [ ] 步骤4: 设置新密码
  - [ ] 步骤5: 完成提示
- [ ] 在登录页面添加"忘记密码"链接
- [ ] 添加路由配置

**后端API**:
```typescript
// 需要新增
POST /api/auth/forgot-password - 发起找回密码
POST /api/auth/verify-reset-code - 验证重置码
POST /api/auth/reset-password - 重置密码
```

**验收标准**:
- 可以通过手机号找回密码
- 可以通过邮箱找回密码
- 流程清晰易懂
- 有安全验证机制

---

#### 2.4 实现全局搜索功能 🔍
**优先级**: P1 - 高
**工作量**: 2天
**影响**: 用户无法快速查找内容

**任务清单**:
- [ ] 创建后端搜索API `/api/search`
- [ ] 实现搜索功能
  - [ ] 作品搜索
  - [ ] 故事搜索
  - [ ] 用户搜索
  - [ ] 知识点搜索
- [ ] 完善前端 `Search.tsx` 页面
  - [ ] 搜索框
  - [ ] 搜索历史
  - [ ] 热门搜索
  - [ ] 搜索结果展示
  - [ ] 分类筛选
- [ ] 实现搜索建议(自动补全)
- [ ] 添加搜索统计

**后端API**:
```typescript
// 需要新增
GET /api/search?q=关键词&type=works|stories|users|knowledge
GET /api/search/suggestions?q=关键词 - 搜索建议
GET /api/search/hot - 热门搜索
POST /api/search/history - 保存搜索历史
GET /api/search/history - 获取搜索历史
```

**技术实现**:
- 使用 PostgreSQL 全文搜索
- 支持模糊匹配
- 按相关度排序

**验收标准**:
- 可以搜索各类内容
- 搜索结果准确
- 有搜索建议
- 搜索速度快

---

#### 2.5 完善学习统计页面 📊
**优先级**: P1 - 高
**工作量**: 1.5天
**影响**: 用户无法查看详细学习数据

**任务清单**:
- [ ] 完善 `LearningData.tsx` 页面
- [ ] 添加数据可视化图表
  - [ ] 学习时长趋势图(折线图)
  - [ ] 知识点掌握度(雷达图)
  - [ ] 学习进度(进度条)
  - [ ] 题目正确率(饼图)
- [ ] 添加数据筛选
  - [ ] 按时间筛选(今日/本周/本月)
  - [ ] 按科目筛选
- [ ] 添加数据导出功能
- [ ] 优化数据展示

**技术实现**:
- 使用 Chart.js 或 Recharts 图表库
- 数据实时更新
- 响应式设计

**验收标准**:
- 图表清晰美观
- 数据准确
- 可以筛选和导出
- 加载速度快

---

### 阶段三: 用户体验优化 (P2 - 中优先级)
**目标**: 提升用户体验和系统完整性
**预计工作量**: 5-7天

#### 3.1 创建帮助中心 ❓
**优先级**: P2 - 中
**工作量**: 2天
**影响**: 用户遇到问题无法自助解决

**任务清单**:
- [ ] 创建 `app/src/pages/HelpCenter.tsx` 页面
- [ ] 编写常见问题FAQ
  - [ ] 账户相关(注册、登录、找回密码)
  - [ ] 学习相关(作业助手、学习地图)
  - [ ] 创作相关(AI创作工具使用)
  - [ ] 游戏相关(游戏规则、积分获取)
  - [ ] 家长端相关(监控设置、报告查看)
- [ ] 实现搜索功能
- [ ] 添加使用教程
  - [ ] 新手引导
  - [ ] 功能介绍视频
  - [ ] 操作步骤图文
- [ ] 添加联系客服入口
- [ ] 在设置页面添加入口

**内容结构**:
```
帮助中心
├── 常见问题
│   ├── 账户问题
│   ├── 学习问题
│   ├── 创作问题
│   └── 其他问题
├── 使用教程
│   ├── 新手指南
│   ├── 功能介绍
│   └── 视频教程
└── 联系我们
    ├── 在线客服
    └── 问题反馈
```

**验收标准**:
- FAQ内容完整
- 可以搜索问题
- 教程清晰易懂
- 界面友好

---

#### 3.2 创建用户反馈页面 💬
**优先级**: P2 - 中
**工作量**: 1天
**影响**: 无法收集用户反馈

**任务清单**:
- [ ] 创建 `app/src/pages/Feedback.tsx` 页面
- [ ] 实现反馈表单
  - [ ] 反馈类型选择(问题反馈/功能建议/其他)
  - [ ] 问题描述
  - [ ] 截图上传
  - [ ] 联系方式
- [ ] 实现反馈提交
- [ ] 显示反馈历史
- [ ] 显示反馈处理状态
- [ ] 在设置页面添加入口

**后端API**:
```typescript
// 需要新增
POST /api/feedback - 提交反馈
GET /api/feedback - 获取我的反馈
GET /api/feedback/:id - 获取反馈详情
```

**验收标准**:
- 可以提交反馈
- 可以上传截图
- 可以查看反馈状态
- 提交成功有提示

---

#### 3.3 完善商城功能 🛒
**优先级**: P2 - 中
**工作量**: 1.5天
**影响**: 商城功能不完整

**任务清单**:
- [ ] 创建 `app/src/pages/ShopItemDetail.tsx` 页面
- [ ] 实现商品详情展示
  - [ ] 商品图片
  - [ ] 商品名称和描述
  - [ ] 价格和库存
  - [ ] 购买按钮
- [ ] 实现商品分类
  - [ ] 虚拟道具
  - [ ] 学习工具
  - [ ] 装饰物品
- [ ] 完善购买流程
  - [ ] 确认购买弹窗
  - [ ] 积分扣除
  - [ ] 购买成功提示
- [ ] 添加我的物品页面

**后端API**:
```typescript
// 需要新增
GET /api/shop/items/:id - 获取商品详情
GET /api/shop/categories - 获取商品分类
GET /api/shop/my-items - 获取我的物品
```

**验收标准**:
- 可以查看商品详情
- 可以按分类浏览
- 购买流程顺畅
- 可以查看已购物品

---

#### 3.4 优化社区互动功能 👥
**优先级**: P2 - 中
**工作量**: 2天
**影响**: 社区互动体验不佳

**任务清单**:
- [ ] 完善评论功能
  - [ ] 评论列表展示
  - [ ] 发表评论
  - [ ] 回复评论
  - [ ] 删除评论
  - [ ] 点赞评论
- [ ] 完善点赞功能
  - [ ] 点赞动画效果
  - [ ] 点赞数实时更新
  - [ ] 取消点赞
- [ ] 创建话题详情页
  - [ ] 话题介绍
  - [ ] 话题下的帖子
  - [ ] 参与话题
- [ ] 创建用户主页
  - [ ] 用户信息
  - [ ] 用户作品
  - [ ] 关注/粉丝
  - [ ] 关注按钮

**后端API** (已存在,需要完善前端):
```typescript
POST /api/community/works/:id/comments - 发表评论
GET /api/community/works/:id/comments - 获取评论
POST /api/community/posts/:id/like - 点赞
GET /api/community/topics/:id - 话题详情
GET /api/users/:id - 用户信息
```

**验收标准**:
- 可以发表和查看评论
- 点赞功能流畅
- 话题页面完整
- 可以查看其他用户主页

---

#### 3.5 添加关于和隐私政策页面 📄
**优先级**: P2 - 中
**工作量**: 0.5天
**影响**: 缺少必要的法律信息

**任务清单**:
- [ ] 创建 `app/src/pages/About.tsx` 页面
  - [ ] 应用介绍
  - [ ] 版本信息
  - [ ] 开发团队
  - [ ] 联系方式
- [ ] 创建 `app/src/pages/PrivacyPolicy.tsx` 页面
  - [ ] 隐私政策内容
  - [ ] 用户协议
  - [ ] 儿童隐私保护
- [ ] 在设置页面添加入口
- [ ] 在登录页面添加链接

**验收标准**:
- 内容完整准确
- 排版清晰
- 符合法律要求

---

### 阶段四: 功能增强 (P3 - 低优先级)
**目标**: 增加额外功能,提升产品竞争力
**预计工作量**: 5-7天

#### 4.1 实现书签和笔记功能 📝
**优先级**: P3 - 低
**工作量**: 2天
**影响**: 阅读体验可以更好

**任务清单**:
- [ ] 在阅读页面添加书签功能
  - [ ] 添加书签按钮
  - [ ] 书签列表
  - [ ] 跳转到书签位置
- [ ] 在学习页面添加笔记功能
  - [ ] 添加笔记按钮
  - [ ] 笔记编辑器
  - [ ] 笔记列表
  - [ ] 笔记搜索

**后端API**:
```typescript
// 需要新增
POST /api/bookmarks - 添加书签
GET /api/bookmarks - 获取书签列表
DELETE /api/bookmarks/:id - 删除书签

POST /api/notes - 创建笔记
GET /api/notes - 获取笔记列表
PUT /api/notes/:id - 更新笔记
DELETE /api/notes/:id - 删除笔记
```

**验收标准**:
- 可以添加和管理书签
- 可以创建和编辑笔记
- 笔记支持富文本
- 可以搜索笔记

---

#### 4.2 完善PK排位赛系统 🏆
**优先级**: P3 - 低
**工作量**: 2天
**影响**: PK系统更有竞争性

**任务清单**:
- [ ] 创建 `app/src/pages/RankedMatch.tsx` 页面
- [ ] 实现排位赛功能
  - [ ] 段位系统(青铜/白银/黄金/铂金/钻石)
  - [ ] 排位积分
  - [ ] 段位晋升/降级
  - [ ] 赛季系统
- [ ] 实现匹配系统
  - [ ] 按段位匹配
  - [ ] 匹配等待
  - [ ] 匹配成功提示
- [ ] 显示排位历史
- [ ] 显示段位排行榜

**后端API**:
```typescript
// 需要扩展
POST /api/pk/ranked/match - 开始排位匹配
GET /api/pk/ranked/history - 排位历史
GET /api/pk/ranked/leaderboard - 排位排行榜
PUT /api/pk/ranked/rating - 更新排位分数
```

**验收标准**:
- 段位系统完整
- 匹配算法合理
- 排行榜准确
- 赛季机制清晰

---

#### 4.3 优化推荐算法 🤖
**优先级**: P3 - 低
**工作量**: 2天
**影响**: 内容推荐更精准

**任务清单**:
- [ ] 优化首页推荐算法
  - [ ] 基于用户兴趣
  - [ ] 基于学习进度
  - [ ] 基于热度
  - [ ] 基于协同过滤
- [ ] 优化学习路径推荐
  - [ ] 基于弱点诊断
  - [ ] 基于学习目标
  - [ ] 基于同龄人数据
- [ ] 优化内容推荐
  - [ ] 故事推荐
  - [ ] 游戏推荐
  - [ ] 作品推荐
- [ ] 添加推荐解释
  - [ ] 为什么推荐这个
  - [ ] 推荐理由

**技术实现**:
- 收集用户行为数据
- 使用机器学习算法
- 实时更新推荐

**验收标准**:
- 推荐内容相关
- 推荐多样性好
- 有推荐解释
- 推荐效果可衡量

---

#### 4.4 增加更多游戏类型 🎮
**优先级**: P3 - 低
**工作量**: 3天
**影响**: 游戏内容更丰富

**任务清单**:
- [ ] 添加新游戏类型
  - [ ] 数学游戏(速算、口算)
  - [ ] 英语游戏(单词拼写、听力)
  - [ ] 科学游戏(实验模拟)
  - [ ] 编程游戏(逻辑训练)
- [ ] 实现游戏关卡系统
  - [ ] 多个难度等级
  - [ ] 关卡解锁机制
  - [ ] 星级评价
- [ ] 添加游戏教程
- [ ] 优化游戏体验

**验收标准**:
- 游戏类型丰富
- 难度设置合理
- 游戏有趣好玩
- 教育意义明确

---

#### 4.5 完善成就系统 🏅
**优先级**: P3 - 低
**工作量**: 1.5天
**影响**: 激励机制更完善

**任务清单**:
- [ ] 添加更多成就类型
  - [ ] 学习成就(连续学习、知识点掌握)
  - [ ] 创作成就(作品数量、作品质量)
  - [ ] 社交成就(好友数量、互动次数)
  - [ ] 游戏成就(游戏通关、高分记录)
- [ ] 实现成就进度追踪
- [ ] 添加成就展示墙
- [ ] 实现成就分享功能
- [ ] 添加成就奖励

**验收标准**:
- 成就类型丰富
- 进度追踪准确
- 成就有吸引力
- 奖励机制合理

---

## 📊 工作量统计

| 阶段 | 优先级 | 任务数 | 预计工作量 | 完成后提升 |
|------|--------|--------|-----------|-----------|
| 阶段一 | P0 | 2 | 1天 | 90% → 92% |
| 阶段二 | P1 | 5 | 8天 | 92% → 96% |
| 阶段三 | P2 | 5 | 7天 | 96% → 98% |
| 阶段四 | P3 | 5 | 11天 | 98% → 100% |
| **总计** | - | **17** | **27天** | **88% → 100%** |

---

## 🎯 里程碑规划

### 里程碑 1: 基础完善 (完成阶段一+阶段二)
**目标**: 核心功能完整,用户体验良好
**完成度**: 96%
**关键成果**:
- ✅ 所有页面可访问
- ✅ 用户设置完整
- ✅ 账户安全完善
- ✅ 搜索功能可用
- ✅ 学习统计完整

### 里程碑 2: 体验优化 (完成阶段三)
**目标**: 用户体验优秀,功能完整
**完成度**: 98%
**关键成果**:
- ✅ 帮助中心完善
- ✅ 用户反馈渠道畅通
- ✅ 商城功能完整
- ✅ 社区互动流畅
- ✅ 法律信息完整

### 里程碑 3: 功能增强 (完成阶段四)
**目标**: 产品竞争力强,功能丰富
**完成度**: 100%
**关键成果**:
- ✅ 书签笔记功能
- ✅ 排位赛系统
- ✅ 推荐算法优化
- ✅ 游戏内容丰富
- ✅ 成就系统完善

---

## 📝 实施建议

### 1. 执行顺序
按照优先级从高到低依次执行:
1. **P0任务** - 立即完成,不可延期
2. **P1任务** - 高优先级,尽快完成
3. **P2任务** - 中优先级,逐步完成
4. **P3任务** - 低优先级,有余力时完成

### 2. 资源分配
- **前端开发**: 60%工作量
- **后端开发**: 30%工作量
- **测试验证**: 10%工作量

### 3. 质量保证
每个任务完成后需要:
- [ ] 代码审查
- [ ] 功能测试
- [ ] 用户体验测试
- [ ] 性能测试
- [ ] 安全测试

### 4. 风险管理
**潜在风险**:
- 技术难度超预期
- 第三方服务依赖
- 数据迁移问题
- 性能瓶颈

**应对措施**:
- 提前技术调研
- 准备备选方案
- 做好数据备份
- 性能监控和优化

### 5. 进度跟踪
- 每日站会同步进度
- 每周回顾完成情况
- 及时调整计划
- 记录问题和解决方案

---

## 🎉 预期成果

完成所有阶段后,项目将达到:
- **功能完整度**: 100%
- **用户体验**: 优秀
- **系统稳定性**: 高
- **产品竞争力**: 强

**核心指标**:
- 所有页面可访问
- 所有功能可用
- 前后端完全对应
- 用户体验流畅
- 无重大bug

---

## 📞 支持与反馈

如有问题或建议,请联系开发团队。

**文档版本**: v1.0
**更新日期**: 2026-02-07
