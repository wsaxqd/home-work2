<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœçŒœæˆ‘æ˜¯è° - AIæ¸¸æˆå®éªŒå®¤ - å¯è’™ä¹‹å…‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e1f5fe 0%, #f3e5f5 100%);
            color: #333;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 0;
            position: relative;
            min-height: 100vh;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(135deg, #00bcd4 0%, #7e57c2 100%);
            color: white;
            border-radius: 0 0 20px 20px;
        }
        
        .back-button {
            font-size: 24px;
            cursor: pointer;
        }
        
        .page-title {
            font-size: 20px;
            text-align: center;
            flex: 1;
        }
        
        .game-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .score {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
        }
        
        .main-content {
            padding: 20px;
            overflow-y: auto;
            max-height: calc(100vh - 140px);
        }
        
        .section-title {
            font-size: 18px;
            margin: 20px 0 15px;
            color: #00bcd4;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: "";
            display: inline-block;
            width: 5px;
            height: 20px;
            background: #00bcd4;
            margin-right: 10px;
            border-radius: 3px;
        }
        
        /* æ¸¸æˆåŒºåŸŸæ ·å¼ */
        .game-area {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 2px solid #e1f5fe;
        }
        
        .game-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .level-indicator {
            font-size: 14px;
            color: #7e57c2;
            font-weight: bold;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 0 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #00bcd4;
            border-radius: 4px;
            width: 30%;
            transition: width 0.5s;
        }
        
        .progress-text {
            font-size: 14px;
            color: #666;
        }
        
        /* å›¾åƒè¯†åˆ«åŒºåŸŸ */
        .recognition-area {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .camera-preview {
            width: 100%;
            height: 250px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        
        .preview-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }
        
        .preview-placeholder {
            font-size: 50px;
            color: #999;
        }
        
        .camera-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .camera-btn {
            width: 60px;
            height: 60px;
            background: #00bcd4;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .camera-btn:hover {
            transform: scale(1.1);
        }
        
        .camera-btn.secondary {
            background: #7e57c2;
        }
        
        .recognition-result {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .result-text {
            font-size: 16px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .confidence-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .confidence-fill {
            height: 100%;
            background: #4caf50;
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .confidence-text {
            font-size: 14px;
            color: #666;
        }
        
        /* å­¦ä¹ å¡ç‰‡æ ·å¼ */
        .learning-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .learning-card {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 2px solid transparent;
        }
        
        .learning-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .learning-card.selected {
            border-color: #00bcd4;
            background: #e1f5fe;
        }
        
        .card-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .card-name {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .card-desc {
            font-size: 12px;
            color: #666;
        }
        
        /* æŒ‘æˆ˜åŒºåŸŸæ ·å¼ */
        .challenge-area {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            background: linear-gradient(135deg, #e1f5fe 0%, #f3e5f5 100%);
            border: 2px dashed #00bcd4;
        }
        
        .challenge-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .challenge-icon {
            font-size: 24px;
            margin-right: 10px;
            color: #00bcd4;
        }
        
        .challenge-title {
            font-size: 16px;
            color: #00bcd4;
        }
        
        .challenge-desc {
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
            color: #666;
        }
        
        .challenge-targets {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
        }
        
        .target-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .target-icon {
            font-size: 30px;
            margin-bottom: 5px;
        }
        
        .target-name {
            font-size: 12px;
            color: #666;
        }
        
        .target-status {
            font-size: 12px;
            margin-top: 5px;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .status-found {
            background: #c8e6c9;
            color: #2e7d32;
        }
        
        .status-missing {
            background: #ffecb3;
            color: #ff8f00;
        }
        
        /* AIåŸç†è¯´æ˜æ ·å¼ */
        .explanation-area {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .explanation-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: #00bcd4;
            display: flex;
            align-items: center;
        }
        
        .explanation-title::before {
            content: "ğŸ¤–";
            margin-right: 10px;
        }
        
        .explanation-content {
            font-size: 14px;
            line-height: 1.6;
            color: #666;
            margin-bottom: 15px;
        }
        
        .neural-network {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            position: relative;
        }
        
        .network-layer {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .layer-label {
            font-size: 12px;
            margin-bottom: 5px;
            color: #666;
        }
        
        .layer-neurons {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .neuron {
            width: 20px;
            height: 20px;
            background: #00bcd4;
            border-radius: 50%;
            opacity: 0.7;
        }
        
        .network-connections {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .connection {
            position: absolute;
            background: rgba(0, 188, 212, 0.2);
            transform-origin: 0 0;
        }
        
        /* æ§åˆ¶æŒ‰é’®æ ·å¼ */
        .control-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
        }
        
        .btn:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: #00bcd4;
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: #0097a7;
            transform: scale(1.03);
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
            transform: scale(1.03);
        }
        
        /* åº•éƒ¨å¯¼èˆªæ ·å¼ */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            background: white;
            padding: 15px 0;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 480px;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .nav-icon {
            font-size: 24px;
            margin-bottom: 5px;
            color: #999;
        }
        
        .nav-item.active .nav-icon {
            color: #00bcd4;
        }
        
        .nav-text {
            font-size: 12px;
            color: #999;
        }
        
        .nav-item.active .nav-text {
            color: #00bcd4;
            font-weight: bold;
        }
        
        /* åŠ¨ç”» */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 480px) {
            .container {
                padding-bottom: 70px;
            }
            
            .learning-cards {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="back-button" onclick="goBack()">â†</div>
            <div class="page-title">çŒœçŒœæˆ‘æ˜¯è°</div>
            <div class="game-info">
                <div class="score">å¾—åˆ†: <span id="score">0</span></div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="game-area">
                <div class="game-progress">
                    <div class="level-indicator">ç¬¬ <span id="current-level">1</span> å…³</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text"><span id="current-progress">3</span>/10</div>
                </div>
                
                <div class="section-title">AIå›¾åƒè¯†åˆ«</div>
                <div class="recognition-area">
                    <div class="camera-preview" id="camera-preview">
                        <div class="preview-placeholder">ğŸ“·</div>
                        <!-- åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºæ‘„åƒå¤´é¢„è§ˆæˆ–ä¸Šä¼ çš„å›¾ç‰‡ -->
                    </div>
                    
                    <div class="camera-controls">
                        <button class="camera-btn" onclick="takePhoto()">ğŸ“¸</button>
                        <button class="camera-btn secondary" onclick="uploadPhoto()">ğŸ“</button>
                        <button class="camera-btn" onclick="analyzeImage()">ğŸ”</button>
                    </div>
                    
                    <div class="recognition-result" id="recognition-result">
                        <div class="result-text">æ‹ä¸€å¼ ç…§ç‰‡æˆ–ä¸Šä¼ å›¾ç‰‡ï¼ŒAIä¼šè¯†åˆ«å®ƒæ˜¯ä»€ä¹ˆï¼</div>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-secondary" onclick="resetGame()">é‡æ–°å¼€å§‹</button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextChallenge()" disabled>ä¸‹ä¸€ä¸ªæŒ‘æˆ˜</button>
                </div>
            </div>
            
            <div class="section-title">å­¦ä¹ å¡ç‰‡</div>
            <div class="learning-cards">
                <div class="learning-card" onclick="selectCard(this, 'animal')">
                    <div class="card-icon">ğŸ¾</div>
                    <div class="card-name">åŠ¨ç‰©è¯†åˆ«</div>
                    <div class="card-desc">è¯†åˆ«å„ç§åŠ¨ç‰©</div>
                </div>
                <div class="learning-card" onclick="selectCard(this, 'fruit')">
                    <div class="card-icon">ğŸ</div>
                    <div class="card-name">æ°´æœè¯†åˆ«</div>
                    <div class="card-desc">è®¤è¯†ä¸åŒæ°´æœ</div>
                </div>
                <div class="learning-card" onclick="selectCard(this, 'vehicle')">
                    <div class="card-icon">ğŸš—</div>
                    <div class="card-name">äº¤é€šå·¥å…·</div>
                    <div class="card-desc">è¯†åˆ«å„ç§è½¦è¾†</div>
                </div>
                <div class="learning-card" onclick="selectCard(this, 'object')">
                    <div class="card-icon">âŒš</div>
                    <div class="card-name">æ—¥å¸¸ç‰©å“</div>
                    <div class="card-desc">è®¤è¯†ç”Ÿæ´»ç”¨å“</div>
                </div>
            </div>
            
            <div class="section-title">ä»Šæ—¥æŒ‘æˆ˜</div>
            <div class="challenge-area">
                <div class="challenge-header">
                    <div class="challenge-icon">ğŸ¯</div>
                    <div class="challenge-title">æ‰¾åˆ°è¿™äº›ç‰©å“</div>
                </div>
                <div class="challenge-desc">
                    ç”¨æ‘„åƒå¤´æ‰¾åˆ°ä»¥ä¸‹ç‰©å“ï¼Œå®ŒæˆæŒ‘æˆ˜å¯ä»¥è·å¾—é¢å¤–å¥–åŠ±ï¼
                </div>
                <div class="challenge-targets">
                    <div class="target-item">
                        <div class="target-icon">ğŸ±</div>
                        <div class="target-name">çŒ«</div>
                        <div class="target-status status-missing">æœªæ‰¾åˆ°</div>
                    </div>
                    <div class="target-item">
                        <div class="target-icon">ğŸ</div>
                        <div class="target-name">è‹¹æœ</div>
                        <div class="target-status status-missing">æœªæ‰¾åˆ°</div>
                    </div>
                    <div class="target-item">
                        <div class="target-icon">ğŸ“±</div>
                        <div class="target-name">æ‰‹æœº</div>
                        <div class="target-status status-missing">æœªæ‰¾åˆ°</div>
                    </div>
                    <div class="target-item">
                        <div class="target-icon">ğŸ“š</div>
                        <div class="target-name">ä¹¦æœ¬</div>
                        <div class="target-status status-missing">æœªæ‰¾åˆ°</div>
                    </div>
                </div>
            </div>
            
            <div class="section-title">AIåŸç†å°çŸ¥è¯†</div>
            <div class="explanation-area">
                <div class="explanation-title">AIæ˜¯æ€ä¹ˆè®¤å‡ºå›¾ç‰‡çš„ï¼Ÿ</div>
                <div class="explanation-content">
                    AIé€šè¿‡ä¸€ç§å«åš"ç¥ç»ç½‘ç»œ"çš„ç³»ç»Ÿæ¥è¯†åˆ«å›¾åƒã€‚å°±åƒæˆ‘ä»¬çš„å¤§è„‘æœ‰ç¥ç»å…ƒä¸€æ ·ï¼ŒAIä¹Ÿæœ‰è™šæ‹Ÿçš„ç¥ç»å…ƒï¼Œå®ƒä»¬ä¸€èµ·å·¥ä½œæ¥è¯†åˆ«å›¾ç‰‡ä¸­çš„æ¨¡å¼ã€‚
                </div>
                
                <div class="neural-network">
                    <div class="network-layer">
                        <div class="layer-label">è¾“å…¥å±‚</div>
                        <div class="layer-neurons">
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                        </div>
                    </div>
                    
                    <div class="network-layer">
                        <div class="layer-label">éšè—å±‚</div>
                        <div class="layer-neurons">
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                        </div>
                    </div>
                    
                    <div class="network-layer">
                        <div class="layer-label">è¾“å‡ºå±‚</div>
                        <div class="layer-neurons">
                            <div class="neuron"></div>
                            <div class="neuron"></div>
                        </div>
                    </div>
                    
                    <div class="network-connections" id="network-connections">
                        <!-- è¿æ¥çº¿å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="explanation-content">
                    AIé€šè¿‡åˆ†ææˆåƒä¸Šä¸‡å¼ å›¾ç‰‡æ¥å­¦ä¹ ï¼Œæ‰¾å‡ºä¸åŒç‰©ä½“çš„ç‰¹å¾ã€‚å½“ä½ ç»™AIçœ‹ä¸€å¼ æ–°å›¾ç‰‡æ—¶ï¼Œå®ƒä¼šæ ¹æ®å­¦åˆ°çš„çŸ¥è¯†çŒœæµ‹å›¾ç‰‡é‡Œæ˜¯ä»€ä¹ˆï¼
                </div>
            </div>
        </div>
        
        <div class="bottom-nav">
            <div class="nav-item" onclick="navigateTo('index.html')">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-text">é¦–é¡µ</div>
            </div>
            <div class="nav-item active" onclick="navigateTo('explore.html')">
                <div class="nav-icon">ğŸ”</div>
                <div class="nav-text">æ¢ç´¢</div>
            </div>
            <div class="nav-item" onclick="navigateTo('create.html')">
                <div class="nav-icon">ğŸ¨</div>
                <div class="nav-text">åˆ›ä½œ</div>
            </div>
            <div class="nav-item" onclick="navigateTo('mind-garden.html')">
                <div class="nav-icon">ğŸ’</div>
                <div class="nav-text">å¿ƒçµ</div>
            </div>
            <div class="nav-item" onclick="navigateTo('profile.html')">
                <div class="nav-icon">ğŸ‘¤</div>
                <div class="nav-text">æˆ‘çš„</div>
            </div>
        </div>
    </div>

    <script src="navigation-template.js"></script>
    <script>
        // æ¸¸æˆçŠ¶æ€å’Œæ•°æ®
        let gameState = {
            score: 0,
            level: 1,
            progress: 3,
            totalChallenges: 10,
            currentCard: '',
            foundItems: [],
            questionsHistory: []
        };
        
        // ä¿å­˜æ¸¸æˆçŠ¶æ€
        function saveGameState() {
            try {
                if (typeof localStorage !== 'undefined') {
                    const gameStateToSave = {
                        ...gameState,
                        lastUpdated: new Date().toISOString()
                    };
                    localStorage.setItem('qmzg_imageGame_state', JSON.stringify(gameStateToSave));
                    console.log('æ¸¸æˆçŠ¶æ€å·²ä¿å­˜');
                }
            } catch (error) {
                console.error('ä¿å­˜æ¸¸æˆçŠ¶æ€å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½æ¸¸æˆçŠ¶æ€
        function loadGameState() {
            try {
                if (typeof localStorage !== 'undefined') {
                    const savedState = localStorage.getItem('qmzg_imageGame_state');
                    if (savedState) {
                        const parsedState = JSON.parse(savedState);
                        // æ£€æŸ¥çŠ¶æ€æ˜¯å¦æ˜¯ä»Šå¤©çš„ï¼Œå¦‚æœè¶…è¿‡24å°æ—¶åˆ™ä¸æ¢å¤
                        const lastUpdated = new Date(parsedState.lastUpdated);
                        const now = new Date();
                        const hoursPassed = (now - lastUpdated) / (1000 * 60 * 60);
                        
                        if (hoursPassed < 24) {
                            // åªæ¢å¤éƒ¨åˆ†å…³é”®çŠ¶æ€ï¼Œä¸åŒ…æ‹¬é—®é¢˜å†å²
                            gameState.score = parsedState.score || 0;
                            gameState.level = parsedState.level || 1;
                            gameState.progress = parsedState.progress || 1;
                            gameState.foundItems = parsedState.foundItems || [];
                            console.log('æ¸¸æˆçŠ¶æ€å·²æ¢å¤');
                            return true;
                        }
                    }
                }
            } catch (error) {
                console.error('åŠ è½½æ¸¸æˆçŠ¶æ€å¤±è´¥:', error);
            }
            return false;
        }
        
        // ä¿å­˜æ¸¸æˆç»“æœ
        function saveGameResult() {
            try {
                const timestamp = new Date().getTime();
                const gameResult = {
                    id: timestamp,
                    gameType: 'image-recognition',
                    score: gameState.score,
                    level: gameState.level,
                    progress: gameState.progress,
                    totalChallenges: gameState.totalChallenges,
                    foundItemsCount: gameState.foundItems.length,
                    completionRate: (gameState.progress / gameState.totalChallenges * 100).toFixed(1) + '%',
                    timestamp: new Date().toISOString()
                };
                
                if (typeof localStorage !== 'undefined') {
                    let gameHistory = JSON.parse(localStorage.getItem('qmzg_gameResults') || '[]');
                    gameHistory.unshift(gameResult);
                    
                    // ä¿ç•™æœ€è¿‘çš„10æ¡è®°å½•
                    if (gameHistory.length > 10) {
                        gameHistory = gameHistory.slice(0, 10);
                    }
                    
                    localStorage.setItem('qmzg_gameResults', JSON.stringify(gameHistory));
                }
                
                console.log('æ¸¸æˆç»“æœå·²ä¿å­˜:', gameResult);
            } catch (error) {
                console.error('ä¿å­˜æ¸¸æˆç»“æœå¤±è´¥:', error);
            }
        }
        
        // å¯¼èˆªåŠŸèƒ½
        function goBack() {
            // ä¿å­˜å½“å‰çŠ¶æ€
            saveGameState();
            window.history.back();
        }
        
        // é€‰æ‹©å­¦ä¹ å¡ç‰‡
        function selectCard(caller, cardType) {
            // æ”¯æŒä¸¤ç§è°ƒç”¨ï¼šselectCard(cardType) æˆ– selectCard(caller, cardType)
            if (typeof cardType === 'undefined') {
                cardType = caller;
                caller = null;
            }

            // ç§»é™¤ä¹‹å‰çš„é€‰æ‹©
            document.querySelectorAll('.learning-card').forEach(card => {
                card.classList.remove('selected');
            });

            // è®¾ç½®æ–°çš„é€‰æ‹©
            var targetEl = null;
            if (caller && caller.nodeType) {
                targetEl = caller;
            } else if (typeof event !== 'undefined' && event.target) {
                targetEl = event.target.closest ? event.target.closest('.learning-card') : event.target;
            }

            if (targetEl) targetEl.classList.add('selected');
            gameState.currentCard = cardType;

            // æ›´æ–°æ¸¸æˆè¯´æ˜
            updateGameInstructions(cardType);
            
            // ä¿å­˜æ¸¸æˆçŠ¶æ€
            saveGameState();
            
            // æ£€æŸ¥æ¸¸æˆæ˜¯å¦å®Œæˆ
            if (gameState.progress >= gameState.totalChallenges) {
                // æ¸¸æˆå®Œæˆï¼Œä¿å­˜ç»“æœ
                saveGameResult();
            }
        }
        
        // æ›´æ–°æ¸¸æˆè¯´æ˜
        function updateGameInstructions(cardType) {
            const instructions = {
                'animal': 'ç°åœ¨è¯•è¯•è¯†åˆ«åŠ¨ç‰©ï¼æ‰¾åˆ°çŒ«ã€ç‹—ã€é¸Ÿç­‰åŠ¨ç‰©ã€‚',
                'fruit': 'ç°åœ¨è¯•è¯•è¯†åˆ«æ°´æœï¼æ‰¾åˆ°è‹¹æœã€é¦™è•‰ã€æ©™å­ç­‰æ°´æœã€‚',
                'vehicle': 'ç°åœ¨è¯•è¯•è¯†åˆ«äº¤é€šå·¥å…·ï¼æ‰¾åˆ°æ±½è½¦ã€è‡ªè¡Œè½¦ã€é£æœºç­‰ã€‚',
                'object': 'ç°åœ¨è¯•è¯•è¯†åˆ«æ—¥å¸¸ç‰©å“ï¼æ‰¾åˆ°æ‰‹æœºã€ä¹¦æœ¬ã€é’Ÿè¡¨ç­‰ã€‚'
            };
            
            const resultElement = document.getElementById('recognition-result');
            resultElement.innerHTML = `<div class="result-text">${instructions[cardType] || 'æ‹ä¸€å¼ ç…§ç‰‡æˆ–ä¸Šä¼ å›¾ç‰‡ï¼ŒAIä¼šè¯†åˆ«å®ƒæ˜¯ä»€ä¹ˆï¼'}</div>`;
        }
        
        // æ‹ç…§åŠŸèƒ½
        function takePhoto() {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨è®¾å¤‡æ‘„åƒå¤´
            // è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹Ÿæ‹ç…§è¿‡ç¨‹
            const preview = document.getElementById('camera-preview');
            preview.innerHTML = '<div class="preview-placeholder pulse">ğŸ“¸ æ‹ç…§ä¸­...</div>';
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿæ‹ç…§å®Œæˆ
                const randomImages = {
                    'animal': 'ğŸ±',
                    'fruit': 'ğŸ',
                    'vehicle': 'ğŸš—',
                    'object': 'ğŸ“±'
                };
                
                const image = gameState.currentCard ? randomImages[gameState.currentCard] : 'ğŸ–¼ï¸';
                preview.innerHTML = `<div class="preview-placeholder">${image}</div>`;
                
                // æ˜¾ç¤ºæç¤º
                const resultElement = document.getElementById('recognition-result');
                resultElement.innerHTML = `
                    <div class="result-text">ç…§ç‰‡å·²æ‹æ‘„ï¼ç‚¹å‡»åˆ†ææŒ‰é’®è¯†åˆ«å›¾ç‰‡å†…å®¹ã€‚</div>
                `;
            }, 1500);
        }
        
        // ä¸Šä¼ ç…§ç‰‡
        function uploadPhoto() {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨
            // è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸Šä¼ è¿‡ç¨‹
            const preview = document.getElementById('camera-preview');
            preview.innerHTML = '<div class="preview-placeholder pulse">ğŸ“ ä¸Šä¼ ä¸­...</div>';
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿä¸Šä¼ å®Œæˆ
                const randomImages = {
                    'animal': 'ğŸ¶',
                    'fruit': 'ğŸŒ',
                    'vehicle': 'ğŸš²',
                    'object': 'ğŸ“š'
                };
                
                const image = gameState.currentCard ? randomImages[gameState.currentCard] : 'ğŸ–¼ï¸';
                preview.innerHTML = `<div class="preview-placeholder">${image}</div>`;
                
                // æ˜¾ç¤ºæç¤º
                const resultElement = document.getElementById('recognition-result');
                resultElement.innerHTML = `
                    <div class="result-text">å›¾ç‰‡å·²ä¸Šä¼ ï¼ç‚¹å‡»åˆ†ææŒ‰é’®è¯†åˆ«å›¾ç‰‡å†…å®¹ã€‚</div>
                `;
            }, 1500);
        }
        
        // åˆ†æå›¾åƒ
        function analyzeImage() {
            const preview = document.getElementById('camera-preview');
            const placeholder = preview.querySelector('.preview-placeholder');
            
            if (!placeholder || placeholder.textContent.includes('ğŸ“·')) {
                alert('è¯·å…ˆæ‹æ‘„æˆ–ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼');
                return;
            }
            
            // æ˜¾ç¤ºåˆ†æä¸­
            const resultElement = document.getElementById('recognition-result');
            resultElement.innerHTML = `
                <div class="result-text">AIæ­£åœ¨åˆ†æå›¾ç‰‡...</div>
                <div class="confidence-bar">
                    <div class="confidence-fill" id="confidence-fill" style="width: 0%"></div>
                </div>
                <div class="confidence-text">åˆ†æè¿›åº¦: <span id="confidence-text">0%</span></div>
            `;
            
            // æ¨¡æ‹ŸAIåˆ†æè¿‡ç¨‹
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                document.getElementById('confidence-fill').style.width = progress + '%';
                document.getElementById('confidence-text').textContent = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    showRecognitionResult();
                }
            }, 100);
        }
        
        // æ˜¾ç¤ºè¯†åˆ«ç»“æœ
        function showRecognitionResult() {
            const resultElement = document.getElementById('recognition-result');
            
            // æ ¹æ®å½“å‰é€‰æ‹©çš„å¡ç‰‡ç±»å‹ç”Ÿæˆç»“æœ
            const results = {
                'animal': {
                    name: 'çŒ«å’ª',
                    confidence: 92,
                    description: 'AIè¯†åˆ«å‡ºè¿™æ˜¯ä¸€åªå¯çˆ±çš„çŒ«å’ªï¼'
                },
                'fruit': {
                    name: 'è‹¹æœ',
                    confidence: 88,
                    description: 'AIè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªçº¢è‹¹æœï¼'
                },
                'vehicle': {
                    name: 'æ±½è½¦',
                    confidence: 85,
                    description: 'AIè¯†åˆ«å‡ºè¿™æ˜¯ä¸€è¾†å°æ±½è½¦ï¼'
                },
                'object': {
                    name: 'æ‰‹æœº',
                    confidence: 90,
                    description: 'AIè¯†åˆ«å‡ºè¿™æ˜¯ä¸€éƒ¨æ™ºèƒ½æ‰‹æœºï¼'
                }
            };
            
            const defaultResult = {
                name: 'æœªçŸ¥ç‰©ä½“',
                confidence: 65,
                description: 'AIä¸å¤ªç¡®å®šè¿™æ˜¯ä»€ä¹ˆï¼Œä½ èƒ½å‘Šè¯‰æˆ‘å—ï¼Ÿ'
            };
            
            const result = gameState.currentCard ? results[gameState.currentCard] : defaultResult;
            
            resultElement.innerHTML = `
                <div class="result-text">${result.description}</div>
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: ${result.confidence}%"></div>
                </div>
                <div class="confidence-text">AIç½®ä¿¡åº¦: ${result.confidence}%</div>
            `;
            
            // æ›´æ–°åˆ†æ•°å’Œè¿›åº¦
            updateScore(result.confidence);
            
            // æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°æŒ‘æˆ˜ç‰©å“
            checkChallengeItems(result.name);
            
            // å¯ç”¨ä¸‹ä¸€ä¸ªæŒ‰é’®
            document.getElementById('next-btn').disabled = false;
        }
        
        // æ›´æ–°åˆ†æ•°
        function updateScore(confidence) {
            const points = Math.floor(confidence / 10);
            gameState.score += points;
            document.getElementById('score').textContent = gameState.score;
        }
        
        // æ£€æŸ¥æŒ‘æˆ˜ç‰©å“
        function checkChallengeItems(itemName) {
            const challengeItems = ['çŒ«', 'è‹¹æœ', 'æ‰‹æœº', 'ä¹¦æœ¬'];
            const targetElements = document.querySelectorAll('.target-name');
            
            targetElements.forEach((element, index) => {
                if (element.textContent === itemName && !gameState.foundItems.includes(itemName)) {
                    gameState.foundItems.push(itemName);
                    const statusElement = element.parentElement.querySelector('.target-status');
                    statusElement.textContent = 'å·²æ‰¾åˆ°';
                    statusElement.className = 'target-status status-found';
                    
                    // é¢å¤–åŠ åˆ†
                    gameState.score += 20;
                    document.getElementById('score').textContent = gameState.score;
                }
            });
        }
        
        // ä¸‹ä¸€ä¸ªæŒ‘æˆ˜
        function nextChallenge() {
            gameState.progress++;
            
            if (gameState.progress > gameState.totalChallenges) {
                gameState.level++;
                gameState.progress = 1;
            }
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            document.getElementById('current-level').textContent = gameState.level;
            document.getElementById('current-progress').textContent = gameState.progress;
            document.getElementById('progress-fill').style.width = (gameState.progress / gameState.totalChallenges * 100) + '%';
            
            // é‡ç½®è¯†åˆ«åŒºåŸŸ
            document.getElementById('camera-preview').innerHTML = '<div class="preview-placeholder">ğŸ“·</div>';
            document.getElementById('recognition-result').innerHTML = '<div class="result-text">æ‹ä¸€å¼ ç…§ç‰‡æˆ–ä¸Šä¼ å›¾ç‰‡ï¼ŒAIä¼šè¯†åˆ«å®ƒæ˜¯ä»€ä¹ˆï¼</div>';
            
            // ç¦ç”¨ä¸‹ä¸€ä¸ªæŒ‰é’®
            document.getElementById('next-btn').disabled = true;
            
            // æ˜¾ç¤ºé¼“åŠ±ä¿¡æ¯
            if (gameState.progress === 1 && gameState.level > 1) {
                alert(`æ­å–œï¼ä½ å·²å‡çº§åˆ°ç¬¬${gameState.level}å…³ï¼ç»§ç»­åŠ æ²¹ï¼`);
            }
        }
        
        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹æ¸¸æˆå—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚')) {
                gameState = {
                    score: 0,
                    level: 1,
                    progress: 1,
                    totalChallenges: 10,
                    currentCard: '',
                    foundItems: []
                };
                
                // é‡ç½®UI
                document.getElementById('score').textContent = '0';
                document.getElementById('current-level').textContent = '1';
                document.getElementById('current-progress').textContent = '1';
                document.getElementById('progress-fill').style.width = '10%';
                document.getElementById('camera-preview').innerHTML = '<div class="preview-placeholder">ğŸ“·</div>';
                document.getElementById('recognition-result').innerHTML = '<div class="result-text">æ‹ä¸€å¼ ç…§ç‰‡æˆ–ä¸Šä¼ å›¾ç‰‡ï¼ŒAIä¼šè¯†åˆ«å®ƒæ˜¯ä»€ä¹ˆï¼</div>';
                document.getElementById('next-btn').disabled = true;
                
                // é‡ç½®å­¦ä¹ å¡ç‰‡é€‰æ‹©
                document.querySelectorAll('.learning-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                // é‡ç½®æŒ‘æˆ˜çŠ¶æ€
                document.querySelectorAll('.target-status').forEach(status => {
                    status.textContent = 'æœªæ‰¾åˆ°';
                    status.className = 'target-status status-missing';
                });
            }
        }
        
        // ç»˜åˆ¶ç¥ç»ç½‘ç»œè¿æ¥
        function drawNeuralNetwork() {
            const connectionsContainer = document.getElementById('network-connections');
            connectionsContainer.innerHTML = '';
            
            // ç®€å•çš„è¿æ¥çº¿ç»˜åˆ¶
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 4; j++) {
                    for (let k = 0; k < 2; k++) {
                        const connection = document.createElement('div');
                        connection.className = 'connection';
                        
                        // è®¾ç½®è¿æ¥çº¿ä½ç½®å’Œæ ·å¼
                        const left = 60 + (i * 120);
                        const top = 30 + (j * 25);
                        const width = 120;
                        const angle = Math.atan2(30 + (k * 25) - top, 120);
                        
                        connection.style.left = left + 'px';
                        connection.style.top = top + 'px';
                        connection.style.width = width + 'px';
                        connection.style.height = '2px';
                        connection.style.transform = `rotate(${angle}rad)`;
                        
                        connectionsContainer.appendChild(connection);
                    }
                }
            }
        }
        
        // åˆå§‹åŒ–å¯¼èˆªå’Œé¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            initAppNavigation();
            // å°è¯•åŠ è½½ä¿å­˜çš„æ¸¸æˆçŠ¶æ€
            if (loadGameState()) {
                // å¦‚æœåŠ è½½äº†æ¸¸æˆçŠ¶æ€ï¼Œæ›´æ–°UIæ˜¾ç¤º
                document.getElementById('score').textContent = gameState.score;
                document.getElementById('current-level').textContent = gameState.level;
                document.getElementById('current-progress').textContent = gameState.progress;
            }
            
            // ç»˜åˆ¶ç¥ç»ç½‘ç»œ
            drawNeuralNetwork();
            
            // åˆå§‹åŒ–è¿›åº¦æ˜¾ç¤º
            document.getElementById('progress-fill').style.width = (gameState.progress / gameState.totalChallenges * 100) + '%';
        });
    </script>
</body>
</html>